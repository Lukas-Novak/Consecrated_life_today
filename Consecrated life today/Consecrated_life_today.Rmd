---
title: Consecrated life today comparision of general health characteristics between non clerial and clerial samples 
author:
  - name: Dana Jaksickova
    affil: 1,\ddagger,*
  - name: Klara Malinakova
    affil: 1,\ddagger,
    orcid: 0000-0001-6939-1204
  - name: Lukas Novak
    affil: 1,\ddagger,
    orcid: 0000-0002-7582-2098
  - name: Peter Tavel
    affil: 1,\ddagger,
    orcid: 0000-0001-7072-001X
affiliation:
  - num: 1
    address: |
      Palacky University Olomouc - 
      Social Health Institute
      Correspondence Univerzitni 244/22, 771 11, Olomouc, Czech Republic
    email: dana.jaksickova@oushi.upol.cz
# firstnote to eighthnote
firstnote: |
  Current address: Updated affiliation
secondnote: |
  These authors contributed equally to this work.
correspondence: |
  dana.jaksickova@oushi.upol.cz; Tel.: +XX-000-00-0000.
journal: ijerph
type: article
status: accept
bibliography: mybibfile.bib
appendix: appendix.tex
simplesummary: |
  A Simple summary goes here.
abstract: |
  dfdfdf
keywords: |
  keyword 1; keyword 2; keyword 3 (list three to ten pertinent keywords specific 
  to the article, yet reasonably common within the subject discipline.).
acknowledgement: |
  All sources of funding of the study should be disclosed. Please clearly 
  indicate grants that you have received in support of your research work. 
  Clearly state if you received funds for covering the costs to publish in open 
  access.
authorcontributions: |
  For research articles with several authors, a short paragraph specifying their 
  individual contributions must be provided. The following statements should be 
  used ``X.X. and Y.Y. conceive and designed the experiments; X.X. performed the 
  experiments; X.X. and Y.Y. analyzed the data; W.W. contributed 
  reagents/materials/analysis tools; Y.Y. wrote the paper.'' Authorship must be
  limited to those who have contributed substantially to the work reported.
conflictsofinterest: |
  Declare conflicts of interest or state 'The authors declare no conflict of 
  interest.' Authors must identify and declare any personal circumstances or
  interest that may be perceived as inappropriately influencing the
  representation or interpretation of reported research results. Any role of the
  funding sponsors in the design of the study; in the collection, analyses or 
  interpretation of data in the writing of the manuscript, or in the decision to 
  publish the results must be declared in this section. If there is no role, 
  please state 'The founding sponsors had no role in the design of the study; 
  in the collection, analyses, or interpretation of data; in the writing of the 
  manuscript, an in the decision to publish the results'.
sampleavailability: |
  Data used for the analysis in this study as well as the code are publically avalible nad can be found on the Open Scienfe Network webside (https://osf.io/ad6b3/).
abbreviations:
  - short: MDPI
    long: Multidisciplinary Digital Publishing Institute
  - short: DOAJ
    long: Directory of open access journals
  - short: TLA
    long: Three letter acronym
  - short: LD 
    long: linear dichroism
  - short: MSE
    long: Mean Square Error
output: rticles::mdpi_article
---
```{r pcgs, include=FALSE}
set.seed(8448923)
packages=c("psych","dplyr","lavaan","base","foreign","Routliers","MVN","parameters", "EFA.MRFA","RGenData","semPlot","psycho","apa","corx","effectsize","qwraps2","finalfit","ggstatsplot","dunn.test","devtools","rticles","ICC.Sample.Size","tidyverse","magrittr","osfr","expss","gtsummary","huxtable","equaltestMI","haven","rcompanion","ufs","readxl") 

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages], repos = "https://cran.r-project.org/")
}
# Packages loading
invisible(lapply(packages, library, character.only = TRUE))
#________________________________________________________________________-
# instal MissMach currently not on the CRAN
miss.mach.url= "https://cran.r-project.org/src/contrib/Archive/MissMech/MissMech_1.0.2.tar.gz"
Miss.Pack=any(rownames(installed.packages()) == "MissMech")
if (any(Miss.Pack == FALSE)) {
  install.packages(miss.mach.url, repos=NULL, type="source")
}
library(MissMech)
#________________________________________________________________________-
# instal citr currently not on the CRAN
Miss.Pack=any(rownames(installed.packages()) == "citr")
if (any(Miss.Pack == FALSE)) {
  devtools::install_github("crsh/citr")
}
library("citr")
#________________________________________________________________________-
# install papaja currently not on the CRAN
Miss.Pack=any(rownames(installed.packages()) == "papaja")
if (any(Miss.Pack == FALSE)) {
  devtools::install_github("crsh/papaja")
}
library("papaja")
#________________________________________________________________________-
```

```{r data loading - REP dataset 2016, include=FALSE}
path.to.dat = paste0(getwd(),"/study data")
# data.rep = read_sav(paste0(path.to.dat,"/Databáze Sadílek 3 - 1800.sav"))

data.rep=read_excel(path = paste0(path.to.dat,"/Databáze Sadílek 3 - 1800.xlsx"))
#(....................................................................................)

# recording variable
data.rep = data.rep %>% 
  mutate(marital_status_all_groups = recode_factor(marital_status_all_groups,
                                                   "1" = "Single",
                                                   "2" = "Married",
                                                   "3" = "Divorced",
                                                   "4" = "Widow/widower",
                                                   "5" = "Unmarried mate"),
         sex = recode_factor(sex,
                             "1" = "Female",
                             "2" = "Male"),
         economical_status_all_groups = recode_factor(economical_status_all_groups,
                                                      "1" = "Student",
                                                      "2" = "Invalid pensioner",
                                                      "3" = "Employed",
                                                      "4" = "Entepreanur",
                                                      "5" = "At home",
                                                      "6" = "Unemployed",
                                                      "7" = "Pensioner"),
         education = recode_factor(education,
                                   "1" = "Basic school",
                                   "2" = "Vocational school or non-maturity highschool", 
                                   "3" = "High school",
                                   "4" = "University"),
         Faith = recode_factor(Faith,
                               "1" = "Yes, I am a member of church",
                               "2" = "Yes, but I am not a member of a church",
                               "3" = "No",
                               "4" = "No, I am convinced atheist"),
         Source = as.factor("Representative")) %>% 
  rename("Gender" = "sex",
         "Family_status" = "marital_status_all_groups",
         "Economical_status" = "economical_status_all_groups",
         "Education" = "education",
         "code" = "CISLO_DOTAZNIKU",
         "hlth_ICHS" = "IHD",
"hlth_chronic_lung_disease" = "IBD",
"hlth_astma" = "asthma",
"hlth_diabetes" = "diabetes", 
"hlth_arthritis" = "artritis",
"hlth_back_pain" = "back_pain", 
"hlth_allergy" = "allergy",
"hlth_depression_anxiety" = "depression_anxiety",
"hlth_obesity" = "obesity", 
"hlth_gastric_or_duodenal_ulcers" = "GD_ulcus",
"hlth_thyroid_disease" = "thyroid_gland_illness",
"hlth_hypertension" = "hypertension",
"hlth_migraine" = "migrena",
"hlth_skin_diseases_eczema" = "ekzema",
"hlth_ICHS" = "IHD",
"hlth_stroke" = "stroke",
"hlth_for_wom_pain_in_the_small_" = "pelvic_pain",
"hlth_pain_of_unclear_origin" = "pain_unclear_origin",
"hlth_cancer" = "cancer") %>% 
 mutate(across(starts_with(c("hlth_")), ~ as.numeric(.)))


data.rep = data.rep %>% select(starts_with(
c("code","Gender","Family_status","Age","Economical_status", "Education", "Faith", "hlth_","DSES1","DSES15"))) %>%  
  select(!contains(c("_other_","IBDonly")))

# summ of all deseases
data.rep = data.rep %>% 
  mutate(General_health = rowSums(across(starts_with(c("hlth_")))))

# Table with inconsistent respondents (FALSE = inconsistent) (feels the God presence despite being Non-religious)
# code_of_inconsistenters.rep = data.rep %>% 
#   mutate(incons_resp = case_when(
#     DSES1 >= 4 & Faith == "No" |
#     DSES1 >= 4 & Faith == "No, I am convinced atheist" |
#     DSES15 >= 4 & Faith == "No" |
#     DSES15 >= 4 & Faith == "No, I am convinced atheist"~ FALSE,
#     TRUE ~ TRUE)) %>%
#   filter(incons_resp == "FALSE") %>% 
#   select(CISLO_DOTAZNIKU)

# exclusion of respondnets which responeded inconsistently 
# data.rep = data.rep %>% 
#   filter(!code %in% code_of_inconsistenters.rep$code)

# "CHPD" = chronic pulmonal desease
# IHD = ischemic heart desease
# GD_ulcus = gastic duodenal colitis
# IBD = inflamatory bowel desease

per.male_female.s1=table(data.rep$Gender)/length(data.rep$Gender) 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r data loading - PA dataset, include=FALSE}
data.pa.raw = readRDS(paste0(path.to.dat,"/data.panel.cons.life.Rds"))

data.pa.raw = data.pa.raw %>% 
  mutate(Source = as.factor("Panel")) %>% 
  filter(low_q_res == "HQ") %>% 
  rename("Economical_status" = "economical_status",
         "Education" = "education",
         "Gender" = "gender"
         ) %>% 
  mutate(Source = as.factor("Panel")) %>% 
  mutate(across(starts_with(c("obtize_","hlth_","OASIS_","ODSIS_")), ~ as.numeric(.))) %>% 
  mutate(OASIS = rowSums(across(starts_with("OASIS_")))) %>% 
  mutate(ODSIS = rowSums(across(starts_with("ODSIS_")))) 


# data.pa.raw %>% # for a some reason numbers > 10 can not be subsated
#   names %>%
#   str_subset(., pattern = "\\d(?=a)")

data.pa.out = data.pa.raw %>% 
  select(ends_with(
c("Gender",
  "Education",
  "Economical_status" ,
  "hlth_ICHS",
"hlth_chronic_lung_disease",
"hlth_diabetes", 
"hlth_astma" ,
"hlth_arthritis",
"hlth_back_pain", 
"hlth_allergy",
"hlth_depression_anxiety",
"hlth_obesity", 
"hlth_gastric_or_duodenal_ulcers",
"hlth_thyroid_disease",
"hlth_hypertension",
"hlth_migraine",
"hlth_skin_diseases_eczema",
"hlth_ICHS",
"hlth_stroke", 
"hlth_for_wom_pain_in_the_small_", 
"hlth_pain_of_unclear_origin",
"hlth_cancer",
"obtize_1a", "obtize_2a", "obtize_3a", "obtize_4a", "obtize_5a", 
"obtize_6a", "obtize_7a", "obtize_8a", "obtize_9a", "obtize_10a", "obtize_11a", "obtize_12a",
"daily_energy",
"psychotherapy","OASIS","ODSIS","code")))

per.male_female.s2=table(data.pa$Gender)/length(data.pa$Gender) 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- Data screening PA dataset ------------------>
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r outliers screening and inconsistent responding detection, include=FALSE}
# calculating MAD 
# OASIS
out_MAD.OA.pa=outliers_mad(data.pa.out$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
# ODSIS
out_MAD.OD.pa=outliers_mad(data.pa.out$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 

# creating dataset only with outliers for screening purposes
# outliers=data.pa.out[c(out_MAD.OA.pa[["outliers_pos"]]), ] %>% view() 
# outliers=data.pa.out[c(out_MAD.OD.pa[["outliers_pos"]]), ] %>% view() 

pa.cod.rem = c("74d9cc54199425db9c2da2cc1d33c923", "06189bd8c5a8850748cd7d634659ff45")

data.pa = data.pa.out %>% # deletetion respondents answering in uniform way - detected by visual inspection  
  filter(!code %in% pa.cod.rem)
```

```{r missing data analysis, include=FALSE}
# Mcar test from different package which can del with more than 50 variables
MCAR.pa.data.mis.mech=MissMech::TestMCARNormality(data = select(.data = data.pa, starts_with(c("OASIS","ODSIS","Age", "obtize_","daily_energy","psychotherapy","hlth_"))))

MCAR.pa.data.mis.mech # MCAR holds 
```

```{r multivariate normality, include=FALSE}
# MULTIVARIATE NORMALITY:
# mvn(data = select(.data = data.pa, starts_with(c("OASIS","ODSIS","Age", "obtize_","daily_energy","psychotherapy","hlth_"))), mvnTest = "mardia", univariatePlot = "histogram")
    
# inspection indicated skewness problems with items: 
Mard=mvn(data= select(.data = data.pa, starts_with(c("OASIS","ODSIS","Age", "obtize_","daily_energy","psychotherapy","hlth_"))),mvnTest = "mardia")    

# summary: # in both datasets, normality in OASIS and ODSIS cen be rejectd
```

```{r Homoscedasticity_and_other_assumptions, include=FALSE}
# OASIS - PA dataset 
# fake regression 
random=rchisq(nrow(data.pa), 7) # generate random data
fake_regres=lm(random~., data = select(data.pa, starts_with(c("OASIS","ODSIS","Age", "obtize_","daily_energy","psychotherapy","hlth_"))),) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r data loading - VACC dataset, include=FALSE}
data.vacc.raw = readRDS(paste0(path.to.dat,"/data.vacc.cons.life.Rds"))

data.vacc = data.vacc.raw %>% 
  filter(low_q_res == "HQ") %>% 
  rename("Faith" = "Religiosity") %>% 
  mutate(Source = as.factor("Vacctination")) %>% 
  mutate(across(starts_with(c("obtize_","hlth_","OASIS_","ODSIS_")), ~ as.numeric(.))) %>% 
  mutate(OASIS = rowSums(across(starts_with("OASIS_")))) %>% 
  mutate(ODSIS = rowSums(across(starts_with("ODSIS_")))) 

data.vacc = data.vacc %>% 
  select(ends_with(c("Gender",
  "Education",
  "Economical_status" ,
  "hlth_ICHS",
"hlth_chronic_lung_disease",
"hlth_diabetes", 
"hlth_astma" ,
"hlth_arthritis",
"hlth_back_pain", 
"hlth_allergy",
"hlth_depression_anxiety",
"hlth_obesity", 
"hlth_gastric_or_duodenal_ulcers",
"hlth_thyroid_disease",
"hlth_hypertension",
"hlth_migraine",
"hlth_skin_diseases_eczema",
"hlth_ICHS",
"hlth_stroke", 
"hlth_for_wom_pain_in_the_small_", 
"hlth_pain_of_unclear_origin",
"hlth_cancer",
"obtize_1a", "obtize_2a", "obtize_3a", "obtize_4a", "obtize_5a", 
"obtize_6a", "obtize_7a", "obtize_8a", "obtize_9a", "obtize_10a", "obtize_11a", "obtize_12a",
"daily_energy",
"OASIS","ODSIS","code"))) # variable "psychotherapy" was not selected because in this survey it also includes "psychiatrist" while in the panel data and consecrated dataset not

per.male_female.s3=table(data.vacc$Gender)/length(data.vacc$Gender) 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- Data screening VACC dataset ---------------->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r outliers screening and inconsistent responding detection, include=FALSE}
# calculating MAD 
# OASIS
out_MAD.OA.vacc=outliers_mad(data.vacc$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
# ODSIS
out_MAD.OD.vacc=outliers_mad(data.vacc$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 

# creating dataset only with outliers for screening purposes
# outliers=data.vacc[c(out_MAD.OA.vacc[["outliers_pos"]]), ] %>% view()
# outliers=data.vacc[c(out_MAD.OD.vacc[["outliers_pos"]]), ] %>% view()

vacc.cod.rem = c("", "")

data.pa = data.vacc %>% # deletetion respondents answering in uniform way - detected by visual inspection  
  filter(!code %in% vacc.cod.rem)
```

```{r missing data analysis, include=FALSE}
# data ex
# how many data are missing
#data.pa %>% select(starts_with(c("OASIS","ODSIS"))) %>% summary
# MCAR.ex.data=BaylorEdPsych::LittleMCAR(select(.data = data.ex, starts_with(c("ODSIS_","OASIS_","Age","obtize_9b","BFI_N_"))))
#.........................................................................................................
# data.pa 
# how many data are missing
#data.pa %>% select(starts_with(c("OASIS","ODSIS"))) %>% summary
# MCAR.pa.data=BaylorEdPsych::LittleMCAR(select(.data = data.pa, starts_with(c("OASIS_","ODSIS_","BFI_N_","RSES","Age"))))
#.........................................................................................................
# Mcar test from different package which can del with more than 50 variables
MCAR.pa.data.mis.mech=MissMech::TestMCARNormality(data = select(.data = data.pa, starts_with(c("OASIS_","ODSIS_","DSES_","BFI_N_","panas","Age","ECI_","GSES_","HSPS","SSDS_","SHSS"))))

# Rationale why imputation was not conducted: 
# In the ex data, we had enought data thus missing cases were deleted listwise. 
# in the pa data, the multiple impuation based on predictive mean maching was used to add valeus (it was possible as only around 26 percent values in rows were missing and it is possible to impute up to 90% without bias see: 
#Madley-Dowd, P., Hughes, R., Tilling, K., & Heron, J. (2019). The proportion of missing data should not be used to guide decisions on multiple imputation. Journal of clinical epidemiology, 110, 63-73.)
```

```{r multivariate normality, include=FALSE}
# loading dataset with imputed values
data.pa=readRDS("data.pa.aft.imp.Rds")

# MULTIVARIATE NORMALITY:
# OASIS
mvn(data = select(.data = data.ex, starts_with("OASIS_")), mvnTest = "mardia", univariatePlot = "histogram")
mvn(data = select(.data = data.pa, starts_with("OASIS_")), mvnTest = "mardia", univariatePlot = "histogram")
# ODSIS
mvn(data = select(.data = data.ex, starts_with("ODSIS_")), mvnTest = "mardia", univariatePlot = "histogram")
mvn(data = select(.data = data.pa, starts_with("ODSIS_")), mvnTest = "mardia", univariatePlot = "histogram")
# inspection indicated skewness problems with items: 
Mard=mvn(data= data.ex[, c("OASIS")],mvnTest = "mardia")    

# summary: # in both datasets, normality in OASIS and ODSIS cen be rejectd
```

```{r Homoscedasticity_and_other_assumptions, include=FALSE}
# OASIS - EX dataset 
# fake regression 
random=rchisq(nrow(data.ex), 7) # generate random data
fake_regres=lm(random~., data= data.ex %>% select(starts_with("OASIS_"))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
#____________________________________________________________________________
# ODSIS - EX dataset 
random=rchisq(nrow(data.ex), 7) # generate random data
fake_regres=lm(random~., data= data.ex %>% select(starts_with("ODSIS_"))) # run fake regression
plot(fake_regres)
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
#*****************************************************************************
# OASIS - PA dataset 
# fake regression 
random=rchisq(nrow(data.pa), 7) # generate random data
fake_regres=lm(random~., data= data.pa %>% select(starts_with("OASIS_"))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
#____________________________________________________________________________
# ODSIS - PA dataset 
random=rchisq(nrow(data.pa), 7) # generate random data
fake_regres=lm(random~., data= data.pa %>% select(starts_with("ODSIS_"))) # run fake regression
plot(fake_regres)
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 

```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r data loading - Concecrated dataset 2011, include=FALSE}
# loading of the recoded data by Gelma
data.cons.from.G = read_excel(path = paste0(path.to.dat,"/data.cons.from.G.xlsx"))
  
# loading of data downloaded from server 
data.cons.long = readRDS(paste0(path.to.dat,"/data.cons.Rds"))

# merging datasets together
data.cons.raw = full_join(x = data.consq.from.G,
                           y = data.consq.long, by = "code") %>% 
  mutate(Source = as.factor("Consecrated")) %>% 
  mutate(across(starts_with(c("obtize_","hlth_")), ~ as.numeric(.)))
#............................................................................................

# removing speeders
data.cons.raw.hq = data.cons.raw %>% 
  filter(low_q_res == "HQ")

# removing Slovak participants
data.cons = data.cons.raw.hq %>% 
  filter(country == "CZ")

data.cons = data.cons %>% 
  mutate(across(starts_with(c("hlth_","OASIS_","ODSIS_")), ~ as.numeric(.))) %>% 
  mutate(OASIS = rowSums(across(starts_with("OASIS_")))) %>% 
  mutate(ODSIS = rowSums(across(starts_with("ODSIS_")))) %>% 
  select(ends_with(c("Gender",
  "Education",
  "Economical_status" ,
  "hlth_ICHS",
"hlth_chronic_lung_disease",
"hlth_diabetes", 
"hlth_astma" ,
"hlth_arthritis",
"hlth_back_pain", 
"hlth_allergy",
"hlth_depression_anxiety",
"hlth_obesity", 
"hlth_gastric_or_duodenal_ulcers",
"hlth_thyroid_disease",
"hlth_hypertension",
"hlth_migraine",
"hlth_skin_diseases_eczema",
"hlth_ICHS",
"hlth_stroke", 
"hlth_for_wom_pain_in_the_small_", 
"hlth_pain_of_unclear_origin",
"hlth_cancer",
"obtize_1a", "obtize_2a", "obtize_3a", "obtize_4a", "obtize_5a", 
"obtize_6a", "obtize_7a", "obtize_8a", "obtize_9a", "obtize_10a", "obtize_11a", "obtize_12a",
"daily_energy",
"psychotherapy",
"OASIS","ODSIS","code"))) 

# sum of all diseases
data.cons = data.cons %>% 
  mutate(General_health = rowSums(across(starts_with(c("hlth_")))))

per.male_female.s4=table(data.cons$Gender)/length(data.cons$Gender) 


#...............................................................
# just basic descriptive
#...............................................................
# data.cons.raw %>% select(starts_with("OASIS_")) %>% describe()
# data.cons.raw %>% select(starts_with("ODSIS_")) %>% describe()
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- Data screening REP dataset 2016------------->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r outliers screening and inconsistent responding detection, include=FALSE}
# calculating MAD 
# OASIS (ex dataset)
out_MAD.OA.ex=outliers_mad(data.ex$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
# OASIS (pa dataset)
out_MAD.OA.pa=outliers_mad(data.pa$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
#...............................................................................................
# ODSIS (ex dataset)
out_MAD.OD.ex=outliers_mad(data.ex$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 
# ODSIS (pa dataset)
out_MAD.OD.pa=outliers_mad(data.pa$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 

# creating dataset only with outliers for screening purposes
# outliers=data.ex[c(out_MAD.OA.ex[["outliers_pos"]]), ] %>% view() 
# outliers=data.pa[c(out_MAD.OA.pa[["outliers_pos"]]), ] %>% view() 
# outliers=data.pa[c(out_MAD.OD.ex[["outliers_pos"]]), ] %>% view() 
# outliers=data.pa[c(out_MAD.OD.pa[["outliers_pos"]]), ] %>% view() 

data.pa = data.pa %>% # deletetion respondents answering in uniform way - detected by visual inspection  
  filter(!code %in% c("74d9cc54199425db9c2da2cc1d33c923", "06189bd8c5a8850748cd7d634659ff45"))

# Table with inconsistent respondents (FALSE = inconsistent) (feels the God presence despite being Non-religious)
code_of_inconsistenters = data.ex %>% 
  mutate(incons_resp = case_when(
    DSES_1 >= 4 & faith == "Non-religious" |
    DSES_1 >= 4 & faith == "No, I am convinced atheist" |
    DSES_15 >= 4 & faith == "Non-religious" |
    DSES_15 >= 4 & faith == "No, I am convinced atheist"~ FALSE,
    TRUE ~ TRUE)) %>%
  filter(incons_resp == "FALSE") %>% 
  select(code)

# exclusion of respondnets which responeded inconsistently
data.ex = data.ex %>% 
  filter(!code %in% code_of_inconsistenters$code)
```

```{r missing data analysis, include=FALSE}
# data ex
# how many data are missing
#data.pa %>% select(starts_with(c("OASIS","ODSIS"))) %>% summary
# MCAR.ex.data=BaylorEdPsych::LittleMCAR(select(.data = data.ex, starts_with(c("ODSIS_","OASIS_","Age","obtize_9b","BFI_N_"))))
#.........................................................................................................
# data.pa 
# how many data are missing
#data.pa %>% select(starts_with(c("OASIS","ODSIS"))) %>% summary
# MCAR.pa.data=BaylorEdPsych::LittleMCAR(select(.data = data.pa, starts_with(c("OASIS_","ODSIS_","BFI_N_","RSES","Age"))))
#.........................................................................................................
# Mcar test from different package which can del with more than 50 variables
MCAR.pa.data.mis.mech=MissMech::TestMCARNormality(data = select(.data = data.pa, starts_with(c("OASIS_","ODSIS_","DSES_","BFI_N_","panas","Age","ECI_","GSES_","HSPS","SSDS_","SHSS"))))

# Rationale why imputation was not conducted: 
# In the ex data, we had enought data thus missing cases were deleted listwise. 
# in the pa data, the multiple impuation based on predictive mean maching was used to add valeus (it was possible as only around 26 percent values in rows were missing and it is possible to impute up to 90% without bias see: 
#Madley-Dowd, P., Hughes, R., Tilling, K., & Heron, J. (2019). The proportion of missing data should not be used to guide decisions on multiple imputation. Journal of clinical epidemiology, 110, 63-73.)
```

```{r imputation procedure, include=FALSE}
# uncheck if the code is available for you
# library(osfr)
# osf_auth("ASK THE FIRST AUTHOR FOR ACCESS")
# project <- osf_retrieve_node("https://osf.io/8ru4s/")
# files <- osf_ls_files(project)
# osf_download(files, conflicts = "overwrite")
# source(knitr::purl("imputation_of_data.panel.rmd", quiet=TRUE))
```

```{r multivariate normality, include=FALSE}
# loading dataset with imputed values
data.pa=readRDS("data.pa.aft.imp.Rds")

# MULTIVARIATE NORMALITY:
# OASIS
mvn(data = select(.data = data.ex, starts_with("OASIS_")), mvnTest = "mardia", univariatePlot = "histogram")
mvn(data = select(.data = data.pa, starts_with("OASIS_")), mvnTest = "mardia", univariatePlot = "histogram")
# ODSIS
mvn(data = select(.data = data.ex, starts_with("ODSIS_")), mvnTest = "mardia", univariatePlot = "histogram")
mvn(data = select(.data = data.pa, starts_with("ODSIS_")), mvnTest = "mardia", univariatePlot = "histogram")
# inspection indicated skewness problems with items: 
Mard=mvn(data= data.ex[, c("OASIS")],mvnTest = "mardia")    

# summary: # in both datasets, normality in OASIS and ODSIS cen be rejectd
```

```{r Homoscedasticity_and_other_assumptions, include=FALSE}
# OASIS - EX dataset 
# fake regression 
random=rchisq(nrow(data.ex), 7) # generate random data
fake_regres=lm(random~., data= data.ex %>% select(starts_with("OASIS_"))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
#____________________________________________________________________________
# ODSIS - EX dataset 
random=rchisq(nrow(data.ex), 7) # generate random data
fake_regres=lm(random~., data= data.ex %>% select(starts_with("ODSIS_"))) # run fake regression
plot(fake_regres)
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
#*****************************************************************************
# OASIS - PA dataset 
# fake regression 
random=rchisq(nrow(data.pa), 7) # generate random data
fake_regres=lm(random~., data= data.pa %>% select(starts_with("OASIS_"))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
#____________________________________________________________________________
# ODSIS - PA dataset 
random=rchisq(nrow(data.pa), 7) # generate random data
fake_regres=lm(random~., data= data.pa %>% select(starts_with("ODSIS_"))) # run fake regression
plot(fake_regres)
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 

```

# Methods

## Measures
ZDE SI MOC PROSÍM POPIŠ, JAKÉ ŠKÁLY A OTÁZKY JSME POUŽILI K MĚŘENÍ TOHO, CO NÁS ZAJÍMALO. VELMI DOPORUČUJI KLÁRY VZHOROVÝ ČLÁNEK, ZDE JE TO POPSÁNO PRVOTŘÍDNĚ

## Participants
In this study, data from in total 4 samples were used. 

### 1. sample  
  First sample (*n* = `r nrow(data.rep)`, Age: *M* = `r mean(data.rep$Age, na.rm = T) %>% round(digits = 2)`, *SD* = `r sd(data.rep$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s1[["Female"]]*100,digits = 2)`%) consisted of participants from nationally representative sample collected in 2016. In this dataset we did not find subjects responding incongruently to the control items regarding a religiosity and spirituality i.e. feeling the God presence despite being Non-religious or atheist. Thus, no participant was excluded from a dataset. 

### 2. sample
  The second sample was collected in.......... From the original dataset (*n* = `r nrow(data.pa.raw)`), we excluded `r nrow(data.pa.raw)-nrow(data.pa.rm.low.q)` participants who responded incongruently to 3 repeatedly asked questions and those, who were speeders (i.e. time spend filling questionnaire was < 10 min.). The three control questions included age (difference > 2 years), weight and height (difference > 2 kilogram and centimes). Hence, the number of participants was `r nrow(data.pa)`. Lastly, we removed records from subjects, which responded to large number of questions in the same way (*n* = `r length(pa.cod.rem)`). Therefore, the final number of participants was `r nrow(data.pa)` (Age: *M* = `r mean(data.pa$Age, na.rm = T) %>% round(digits = 2)`, *SD* = `r sd(data.pa$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s2[["Female"]]*100,digits = 2)`%). 

### 3. sample 
  The third sample (*n* = `r nrow(data.vacc)`) was collected during May 2021 (zde moc psl dopln další info). After data were collected, we excluded participants (*n* = `r nrow(data.vacc.raw)-nrow(data.vacc)`) reporting inconsistent answers and those who were classified as speeders. The criteria were the same as in the second sample. This resulted in `r nrow(data.vacc)` (Age: *M* = `r mean(data.vacc$Age, na.rm = T) %>% round(digits = 2)`, *SD* = `r sd(data.vacc$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s3[["Female"]]*100,digits = 2)`%) participants.      

### 4. sample 
  We collected `r nrow(data.consq.raw)` participants. In the first step, we excluded participants (*n* = `r nrow(data.cons.raw) - nrow(data.cons.raw.hq)`) who were classified as speeders i.e. finished questionnaire typically lasting more than 30 minutes in < 10 minutes. After this exclucion, `r nrow(data.cons.raw.hq)` participants remained. In the further step,  we removed those not being Czechs citizens (*n* = `r nrow(data.cons.raw.hq) - nrow(data.cons)`) (JE TO TAKTO PRAVDA? KDYŽTAK TO MOC PROSÍM POPIŠ TAK, ABY TO ODPOVÍDALO) resulting in `r nrow(data.cons)` subjects (Age: *M* = `r mean(data.cons$Age, na.rm = T) %>% round(digits = 2)`, *SD* = `r sd(data.cons$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s4[["Female"]]*100,digits = 2)`%).      
  







# toto ověřit !!! 
As the null hypotheses of the MCAR test in all our surveys was not rejected, we deleted missing values listwise.  


## Statistical analysis


# Results

<!-- This section may be divided by subheadings. It should provide a concise and precise description of the experimental results, their interpretation as well as the experimental conclusions that can be drawn. -->

## Subsection Heading Here

<!-- Subsection text here. -->

### Subsubsection Heading Here

Bulleted lists look like this:

<!-- * First bullet -->
<!-- * Second bullet -->
<!-- * Third bullet -->

<!-- Numbered lists can be added as follows: -->

<!-- 1. First item -->
<!-- 2. Second item -->
<!-- 3. Third item -->

<!-- The text continues here. -->

<!-- All figures and tables should be cited in the main text as Figure 1, Table 1, etc. -->

<!-- \begin{figure}[H] -->
<!-- \centering -->
<!-- \includegraphics[width=3 cm]{logo-mdpi} -->
<!-- \caption{This is a figure, Schemes follow the same formatting. If there are multiple panels, they should be listed as: (\textbf{a}) Description of what is contained in the first panel. (\textbf{b}) Description of what is contained in the second panel. Figures should be placed in the main text near to the first time they are cited. A caption on a single line should be centered.} -->
<!-- \end{figure} -->


<!-- \begin{table}[H] -->
<!-- \caption{This is a table caption. Tables should be placed in the main text near to the first time they are cited.} -->
<!-- \centering -->
<!-- %% \tablesize{} %% You can specify the fontsize here, e.g.  \tablesize{\footnotesize}. If commented out \small will be used. -->
<!-- \begin{tabular}{ccc} -->
<!-- \toprule -->
<!-- \textbf{Title 1}	& \textbf{Title 2}	& \textbf{Title 3}\\ -->
<!-- \midrule -->
<!-- entry 1		& data			& data\\ -->
<!-- entry 2		& data			& data\\ -->
<!-- \bottomrule -->
<!-- \end{tabular} -->
<!-- \end{table} -->

<!-- This is an example of an equation: -->

<!-- \begin{equation} -->
<!-- \mathbb{S} -->
<!-- \end{equation} -->
<!-- If the documentclass option "submit" is chosen, please insert a blank line before and after any math environment (equation and eqnarray environments). This ensures correct linenumbering. The blank line should be removed when the documentclass option is changed to "accept" because the text following an equation should not be a new paragraph. -->

<!-- Please punctuate equations as regular text. Theorem-type environments (including propositions, lemmas, corollaries etc.) can be formatted as follows: -->
<!-- Example of a theorem: -->
<!-- \begin{Theorem} -->
<!-- Example text of a theorem. -->
<!-- \end{Theorem} -->

<!-- The text continues here. Proofs must be formatted as follows: -->

<!-- Example of a proof: -->
<!-- \begin{proof}[Proof of Theorem 1] -->
<!-- Text of the proof. Note that the phrase `of Theorem 1' is optional if it is clear which theorem is being referred to. -->
<!-- \end{proof} -->
<!-- The text continues here. -->

# Discussion

<!-- Authors should discuss the results and how they can be interpreted in perspective of previous studies and of the working hypotheses. The findings and their implications should be discussed in the broadest context possible. Future research directions may also be highlighted. -->

# Conclusion

<!-- This section is not mandatory, but can be added to the manuscript if the discussion is unusually long or complex. -->

# Patents

<!-- This section is not mandatory, but may be added if there are patents resulting from the work reported in this manuscript. -->

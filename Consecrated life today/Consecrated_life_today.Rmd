---
title: Czech and Slovak members of religious institutes their health in comparison to general population
author:
  - name: Dana Jaksicova
    affil: 1,\ddagger,
    orcid: 0000-0001-6087-9545
  - name: Lukas Novak
    affil: 1,\ddagger,*
    orcid: 0000-0002-7582-2098   
  - name: Vit Husek
    affil: 1,\ddagger,
    orcid: 0000-0001-6989-2383 
  - name: Peter Tavel
    affil: 1,\ddagger,
    orcid: 0000-0001-7072-001X
  - name: Klara Malinakova
    affil: 1,\ddagger,
    orcid: 0000-0001-6939-1204
affiliation:
  - num: 1
    address: |
      Palacky University Olomouc - 
      Social Health Institute
      Correspondence Univerzitni 244/22, 771 11, Olomouc, Czech Republic
    email: dana.jaksicova@oushi.upol.cz (D.J.); lukas.novak@oushi.upol.cz (L.N.); vit.husek@upol.cz (V.H.); peter.tavel@oushi.upol.cz (P.T.); klara.malinakova@oushi.upol.cz (K.M.)
firstnote: |
secondnote: |
  These authors contributed equally to this work.
correspondence: |
  dana.jaksicova@oushi.upol.cz; Tel.: +420-721-962-369.
journal: ijerph
type: article
status: accept
bibliography: mybibfile.bib
appendix: appendix.tex
abstract: |
  The study examines the general health of consecrated persons (CP) in the Czech Republic (CZ) and in Slovakia (SK) compared to control samples of Czech population. Compared to the previous studies from some western countries, we expected a higher level of adverse health affecting factors among CP in post-communist CZ and SK. The sample of 293 CP participants (age: M = 47.52, SD = 9.57, females: 78.88%, 180 Czechs, 213 Slovaks) was compared with two control samples, one was nationally representative. Comparing CP with general population, we measured the frequency of recent health complains, the occurrence of chronic illnesses, the general health and the individual chronotype. CP compared to the representative sample had a higher chance of suffering from small pelvis pain and obesity, but a lower chance of diabetes. Further, CP had higher odds of having worse general health. Comparing “larks” with “night owls” among CP, “night owls” had a significantly higher chance of suffering from worse general health. “Night owl CP” also seem to suffer more from backache and depression/anxiety and to have more problems with falling asleep. Compared to the major society, CP in CZ and SK tend to have a similar or a slightly worse general health. The results differ from the US findings pointing at the positive health effects of spiritual experience and structured daily routine of CP. Thus, this study shows the importance of more detailed research on the way of life of Czech and Slovak CP to determine the factors with the most negative health effects.
keywords: |
  spirituality; consecrated person; health; religious institutes; Czech; Slovak
acknowledgement: |
  All sources of funding of the study should be disclosed. Please clearly 
  indicate grants that you have received in support of your research work. 
  Clearly state if you received funds for covering the costs to publish in open 
  access.
authorcontributions: |
  For research articles with several authors, a short paragraph specifying their 
  individual contributions must be provided. The following statements should be 
  used ``X.X. and Y.Y. conceive and designed the experiments; X.X. performed the 
  experiments; X.X. and Y.Y. analyzed the data; W.W. contributed 
  reagents/materials/analysis tools; Y.Y. wrote the paper.'' Authorship must be
  limited to those who have contributed substantially to the work reported.
conflictsofinterest: |
  Declare conflicts of interest or state 'The authors declare no conflict of 
  interest.' Authors must identify and declare any personal circumstances or
  interest that may be perceived as inappropriately influencing the
  representation or interpretation of reported research results. Any role of the
  funding sponsors in the design of the study; in the collection, analyses or 
  interpretation of data in the writing of the manuscript, or in the decision to 
  publish the results must be declared in this section. If there is no role, 
  please state 'The founding sponsors had no role in the design of the study; 
  in the collection, analyses, or interpretation of data; in the writing of the 
  manuscript, an in the decision to publish the results'.
sampleavailability: |
  Study data and R code are availible on Open Science Framework website [accessed date: 10 August 2021] (https://osf.io/tv6m5/).
abbreviations:
  - short: MDPI
    long: Multidisciplinary Digital Publishing Institute
  - short: DOAJ
    long: Directory of open access journals
  - short: TLA
    long: Three letter acronym
  - short: LD 
    long: linear dichroism
  - short: MSE
    long: Mean Square Error
output: rticles::mdpi_article
---
```{r pcgs, include=FALSE}
set.seed(8448923)
packages=c("psych","dplyr","lavaan","base","foreign","Routliers","MVN","parameters", "EFA.MRFA","RGenData","semPlot","psycho","apa","corx","effectsize","qwraps2","finalfit","ggstatsplot","dunn.test","devtools","rticles","ICC.Sample.Size","tidyverse","magrittr","osfr","expss","gtsummary","huxtable","equaltestMI","haven","rcompanion","ufs","readxl","ordinal",
           "brant") 

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages], repos = "https://cran.r-project.org/")
}
# Packages loading
invisible(lapply(packages, library, character.only = TRUE))
#________________________________________________________________________-
# instal MissMach currently not on the CRAN
miss.mach.url= "https://cran.r-project.org/src/contrib/Archive/MissMech/MissMech_1.0.2.tar.gz"
Miss.Pack=any(rownames(installed.packages()) == "MissMech")
if (any(Miss.Pack == FALSE)) {
  install.packages(miss.mach.url, repos=NULL, type="Source")
}
library(MissMech)
#________________________________________________________________________-
# instal citr currently not on the CRAN
Miss.Pack=any(rownames(installed.packages()) == "citr")
if (any(Miss.Pack == FALSE)) {
  devtools::install_github("crsh/citr")
}
library("citr")
#________________________________________________________________________-
# install papaja currently not on the CRAN
Miss.Pack=any(rownames(installed.packages()) == "papaja")
if (any(Miss.Pack == FALSE)) {
  devtools::install_github("crsh/papaja")
}
library("papaja")
#________________________________________________________________________-
```

```{r data loading - REP dataset 2016, include=FALSE}
path.to.dat = paste0(getwd(),"/study data")
# data.rep = read_sav(paste0(path.to.dat,"/Databáze Sadílek 3 - 1800.sav"))

data.rep=read_excel(path = paste0(path.to.dat,"/Databáze Sadílek 3 - 1800.xlsx"))
#(....................................................................................)

# recording variable
data.rep = data.rep %>% 
  mutate(marital_status_all_groups = recode_factor(marital_status_all_groups,
                                                   "1" = "Not in relationship",
                                                   "2" = "Married",
                                                   "3" = "Divorced",
                                                   "4" = "Widow/Widower",
                                                   "5" = "In relationship"),
         sex = recode_factor(sex,
                             "1" = "Female",
                             "2" = "Male"),
         economical_status_all_groups = recode_factor(economical_status_all_groups,
                                                      "1" = "Without work",
                                                      "2" = "Pensioner",
                                                      "3" = "Working",
                                                      "4" = "Working",
                                                      "5" = "Without work",
                                                      "6" = "Without work",
                                                      "7" = "Pensioner"),
         education = recode_factor(education,
                                   "1" = "Basic school",
                                   "2" = "Vocational school or non - maturity high school", 
                                   "3" = "High school",
                                   "4" = "Higher vocational school or University"),
         Faith = recode_factor(Faith,
                               "1" = "Yes, I am a member of church",
                               "2" = "Yes, but I am not a member of a church",
                               "3" = "No",
                               "4" = "No, I am convinced atheist"),
         Source = as.factor("Representative")) %>% 
  rename("Gender" = "sex",
         "Family_status" = "marital_status_all_groups",
         "Economical_status" = "economical_status_all_groups",
         "Education" = "education",
         "code" = "CISLO_DOTAZNIKU",
         "hlth_ICHS" = "IHD",
"hlth_chronic_lung_disease" = "IBD",
"hlth_astma" = "asthma",
"hlth_diabetes" = "diabetes", 
"hlth_arthritis" = "artritis",
"hlth_back_pain" = "back_pain", 
"hlth_allergy" = "allergy",
"hlth_depression_anxiety" = "depression_anxiety",
"hlth_obesity" = "obesity", 
"hlth_gastric_or_duodenal_ulcers" = "GD_ulcus",
"hlth_thyroid_disease" = "thyroid_gland_illness",
"hlth_hypertension" = "hypertension",
"hlth_migraine" = "migrena",
"hlth_skin_diseases_eczema" = "ekzema",
"hlth_ICHS" = "IHD",
"hlth_stroke" = "stroke",
"hlth_for_wom_pain_in_the_small_" = "pelvic_pain",
"hlth_pain_of_unclear_origin" = "pain_unclear_origin",
"hlth_cancer" = "cancer") %>% 
 mutate(across(starts_with(c("hlth_")), ~ as.numeric(.))) %>% 
  mutate(code = as.character(code))


data.rep = data.rep %>% select(starts_with(
c("code","Gender","Family_status","Age","Economical_status", "Education", "Faith", "hlth_","DSES1","DSES15","Source"))) %>%  
  select(!contains(c("_other_","IBDonly")))

# summ of all deseases
data.rep = data.rep %>% 
  mutate(General_health = rowSums(across(starts_with(c("hlth_")))))

# Table with inconsistent respondents (FALSE = inconsistent) (feels the God presence despite being Non-religious)
# code_of_inconsistenters.rep = data.rep %>% 
#   mutate(incons_resp = case_when(
#     DSES1 >= 4 & Faith == "No" |
#     DSES1 >= 4 & Faith == "No, I am convinced atheist" |
#     DSES15 >= 4 & Faith == "No" |
#     DSES15 >= 4 & Faith == "No, I am convinced atheist"~ FALSE,
#     TRUE ~ TRUE)) %>%
#   filter(incons_resp == "FALSE") %>% 
#   select(CISLO_DOTAZNIKU)

# exclusion of respondnets which responeded inconsistently 
# data.rep = data.rep %>% 
#   filter(!code %in% code_of_inconsistenters.rep$code)

# "CHPD" = chronic pulmonal desease
# IHD = ischemic heart desease
# GD_ulcus = gastic duodenal colitis
# IBD = inflamatory bowel desease

per.male_female.s1=table(data.rep$Gender)/length(data.rep$Gender) 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r data loading - PA dataset, include=FALSE}
data.pa.raw = readRDS(paste0(path.to.dat,"/data.panel.cons.life.Rds"))

data.pa.hq = data.pa.raw %>% 
  mutate(Source = as.factor("Panel")) %>% 
  filter(low_q_res == "HQ") %>% 
  rename("Economical_status" = "economical_status",
         "Education" = "education",
         "Gender" = "gender",
         "Age" = "age",
         "Family_status" = "family_status"
         ) %>% 
  mutate(Family_status = recode_factor(Family_status, 
                                       "In relationship" = "In relationship",
                                       "Married" = "Married",
                                       "Unmarried" = "Not in relationship",
                                       "Divorced" = "Divorced",
                                       "Widow" = "Widow/Widower")) %>% 
  
  mutate(across(starts_with(c("obtize_","OASIS_","ODSIS_","hlth_")), ~ as.numeric(.))) %>% 
  mutate(across(starts_with(c("hlth_")), ~ dplyr::recode(., 
                                                  "1" = 0,
                                                  "2" = 1 ))) %>% 
  mutate(OASIS = rowSums(across(starts_with("OASIS_")))) %>% 
  mutate(ODSIS = rowSums(across(starts_with("ODSIS_")))) %>% 
  mutate(Education = recode_factor(Education,
                                   "Basic school" = "Basic school",
                                   "Vocational school or non - maturity high school" = "Vocational school or non - maturity high school", 
                                   "High school" = "High school",
                                   "Higher vocational school or University bachelor" = "Higher vocational school or University", 
                                   "University master or higher" = "Higher vocational school or University", .ordered = F), 
             Economical_status = recode_factor(Economical_status,
                                            "Employed" = "Working",
                                            "Entrepreneur with > 6 employes" = "Working", 
                                            "Entrepreneur with 1 - 5 employes" = "Working", 
                                            "Entrepreneur without employes" = "Working", 
                                            "In household" = "Without work",
                                            "Invalidity pensioner" = "Pensioner",
                                            "Maternity leave" = "Without work", 
                                            "Not working pensioner" = "Pensioner", 
                                            "Pensioner" = "Pensioner", 
                                            "Student" = "Without work",
                                            "Without work" = "Without work")) %>% 
  mutate(daily_energy = recode_factor(daily_energy,
                                      "1" = "Early bird",
                                      "2" = "Night own"),
                  psychotherapy = recode_factor(psychotherapy,
                                       "1" = "Yes",
                                       "2" = "No")) %>% 
  mutate(across(starts_with("obtize_"), ~ dplyr::recode(.,
                                                "1" = "Not many times per week",
                                                "2" = "Not many times per week",
                                                "3" = "Not many times per week",
                                                "4" = "Many times a week",
                                                "5" = "Many times a week")))

# data.pa.raw %>% # for a some reason numbers > 10 can not be subsated
#   names %>%
#   str_subset(., pattern = "\\d(?=a)")

data.pa.out = data.pa.hq %>% 
  select(ends_with(
c("Gender","Age",
  "Education",
  "Economical_status" ,
  "hlth_ICHS",
"hlth_chronic_lung_disease",
"hlth_diabetes", 
"hlth_astma" ,
"hlth_arthritis",
"hlth_back_pain", 
"hlth_allergy",
"hlth_depression_anxiety",
"hlth_obesity", 
"hlth_gastric_or_duodenal_ulcers",
"hlth_thyroid_disease",
"hlth_hypertension",
"hlth_migraine",
"hlth_skin_diseases_eczema",
"hlth_ICHS",
"hlth_stroke", 
"hlth_for_wom_pain_in_the_small_", 
"hlth_pain_of_unclear_origin",
"hlth_cancer",
"obtize_1a", "obtize_2a", "obtize_3a", "obtize_4a", "obtize_5a", 
"obtize_6a", "obtize_7a", "obtize_8a", "obtize_9a", "obtize_10a", "obtize_11a", "obtize_12a",
"daily_energy", "Family_status",
"psychotherapy","OASIS","ODSIS","code","Source")))

# summ of all deseases
data.pa.out = data.pa.out %>% 
  mutate(General_health = rowSums(across(starts_with(c("hlth_")))))
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- Data screening PA dataset ------------------>
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r outliers screening and inconsistent responding detection pa, include=FALSE}
# calculating MAD 
# OASIS
out_MAD.OA.pa=outliers_mad(data.pa.out$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
# ODSIS
out_MAD.OD.pa=outliers_mad(data.pa.out$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 

# creating dataset only with outliers for screening purposes
# data.pa.out %>% filter(OASIS %in% out_MAD.OA.pa$outliers) %>% view()
# data.pa.out %>% filter(ODSIS %in% out_MAD.OD.pa$outliers) %>% view()

pa.cod.rem = c("74d9cc54199425db9c2da2cc1d33c923", "06189bd8c5a8850748cd7d634659ff45")

data.pa = data.pa.out %>% # deletetion respondents answering in uniform way - detected by visual inspection  
  filter(!code %in% pa.cod.rem)

per.male_female.s2=table(data.pa$Gender)/length(data.pa$Gender) 
```

```{r missing data analysis pa, include=FALSE}
# Mcar test from different package which can del with more than 50 variables
MCAR.pa.data.mis.mech=MissMech::TestMCARNormality(data = select(.data = data.pa, starts_with(c("OASIS","ODSIS","Age","hlth_"))))

MCAR.pa.data.mis.mech # MCAR holds 
```

```{r multivariate normality pa, include=FALSE}
# MULTIVARIATE NORMALITY:
# mvn(data = select(.data = data.pa, starts_with(c("OASIS","ODSIS","Age","daily_energy","psychotherapy","hlth_"))), mvnTest = "mardia", univariatePlot = "histogram")
    
# inspection indicated skewness problems with items: 
Mard=mvn(data= select(.data = data.pa, starts_with(c("OASIS","ODSIS","Age","hlth_"))),mvnTest = "mardia")    

# summary: # in both datasets, normality in OASIS and ODSIS cen be rejectd
```

```{r Homoscedasticity_and_other_assumptions pa, include=FALSE}
# OASIS - PA dataset 
# fake regression 
random=rchisq(nrow(data.pa), 7) # generate random data
fake_regres=lm(random~., data = select(data.pa, starts_with(c("OASIS","ODSIS","Age", "obtize_","daily_energy","psychotherapy","hlth_", "Gender", "Education")))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r data loading - VACC dataset, include=FALSE}
data.vacc.raw = readRDS(paste0(path.to.dat,"/data.vacc.cons.life.Rds"))

data.vacc = data.vacc.raw %>% 
  filter(low_q_res == "HQ") %>% 
  rename("Faith" = "Religiosity") %>% 
  mutate(Source = as.factor("Vacctination")) %>% 
  mutate(across(starts_with(c("obtize_","hlth_","OASIS_","ODSIS_")), ~ as.numeric(.))) %>%   
  mutate(OASIS = rowSums(across(starts_with("OASIS_")))) %>% 
  mutate(ODSIS = rowSums(across(starts_with("ODSIS_")))) %>% 
  rename(hlth_for_wom_pain_in_the_small_ = hlth_women_pain_in_small_etc) %>% 
  mutate(Education = recode_factor(Education, 
                                   "Basic school" = "Basic school", 
                                   "Vocational school or non - maturity high school" = "Vocational school or non - maturity high school",
                                   "High school" = "High school",
                                   "Higher vocational school" = "Higher vocational school or University",
                                   "University bachelor" = "Higher vocational school or University",
                                   "University master" = "Higher vocational school or University",
                                   "University Dr" = "Higher vocational school or University",
                                   "other: Ph.D." = "Higher vocational school or University"), 
                    Economical_status = recode_factor(Economical_status, 
                                            "Student" = "Without work",
                                            "Invalidy pensioner" = "Pensioner", 
                                            "Employed" = "Working",
                                            "Enterpreanuer" = "Working",
                                            "Not working" = "Without work",
                                            "Pensioner"="Pensioner",
                                            "Maternity leave"="Without work",
                                            "Without work" = "Without work",
                                            "In household" = "Without work",
                                            "other: invalidní duchod" = "Pensioner",
                                             .default = NA_character_),
         Faith = recode_factor(Faith,
                               "Yes, I am a member or church/rel.society" = "Yes, I am a member of church",
                               "Yes, but I am not a member of church/rel.society" = "Yes, but I am not a member of a church"))


data.vacc = data.vacc %>% 
    mutate(hlth_depression_anxiety = case_when(
    hlth_psych_anxiety == "1" | 
      hlth_psych_depress == "1" ~ 1, 
    TRUE ~ 0
  )) %>% 
  select(starts_with(c("Age","Gender",
  "Education",
  "Faith",
  "Economical_status" ,
  "hlth_ICHS",
  "Family_status",
"hlth_chronic_lung_disease",
"hlth_diabetes", 
"hlth_astma" ,
"hlth_arthritis",
"hlth_back_pain", 
"hlth_allergy",
"hlth_depression_anxiety",
"hlth_obesity", 
"hlth_gastric_or_duodenal_ulcers",
"hlth_thyroid_disease",
"hlth_hypertension",
"hlth_migraine",
"hlth_skin_diseases_eczema",
"hlth_ICHS",
"hlth_stroke", 
"hlth_for_wom_pain_in_the_small_", 
"hlth_pain_of_unclear_origin",
"hlth_cancer", "daily_energy",
"obtize_1a", "obtize_2a", "obtize_3a", "obtize_4a", "obtize_5a", 
"obtize_6a", "obtize_7a", "obtize_8a", "obtize_9a", 
"obtize_10a", "obtize_11a", "obtize_12a",  # variable "psychotherapy" was not selected because in this survey it also includes "psychiatrist" while in the panel data and consecrated dataset not 
"OASIS","ODSIS","code","Source"))) %>% 
select(!ends_with("education_type")) %>% 
  select(!starts_with("Source_"))

# summ of all deseases
data.vacc = data.vacc %>% 
  mutate(General_health = rowSums(across(starts_with(c("hlth_")))))

per.male_female.s3=table(data.vacc$Gender)/length(data.vacc$Gender) 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- Data screening VACC dataset ---------------->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r outliers screening and inconsistent responding detection, include=FALSE}
# calculating MAD 
# OASIS
out_MAD.OA.vacc=outliers_mad(data.vacc$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
# ODSIS
out_MAD.OD.vacc=outliers_mad(data.vacc$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 

# creating dataset only with outliers for screening purposes
# data.vacc %>% filter(OASIS %in% out_MAD.OA.vacc$outliers) %>% view()
# data.vacc %>% filter(ODSIS %in% out_MAD.OD.vacc$outliers) %>% view()

# screening was conducted via examination of the uniform pattern of responding across deseases and OASIS and ODSIS score - if particpants responded that he or she suffers from all deseases and the report extreme scores in OASIS or ODSIS, than this respondent was labeled as low quality respondet 
```

```{r missing data analysis, include=FALSE}
MCAR.vacc.data.mis.mech=MissMech::TestMCARNormality(data = select(.data = data.vacc, starts_with(c("OASIS_","ODSIS_","obtize_", "Age")))) # MCAR holds
```

```{r multivariate normality, include=FALSE}
# mvn(data = select(.data = data.vacc, starts_with(c("OASIS","ODSIS","obtize_","hlth_","Age"))), mvnTest = "mardia", univariatePlot = "histogram")
# inspection indicated skewness problems with items: 
Mard=mvn(data= select(.data = data.vacc, starts_with(c("OASIS","ODSIS","hlth_", "Age"))),mvnTest = "mardia")    

# summary: # in both datasets, normality in OASIS and ODSIS can be rejected
```

```{r Homoscedasticity_and_other_assumptions, include=FALSE}
# fake regression 
random=rchisq(nrow(data.vacc), 7) # generate random data
fake_regres=lm(random~., data= data.vacc %>% select(starts_with(c("OASIS","ODSIS","obtize_","hlth_", "Age", "Gender", "Education")))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r data loading - Concecrated dataset 2011, include=FALSE}
# loading of the recoded data by Gelma
data.cons.from.G = read_excel(path = paste0(path.to.dat,"/data.cons.from.G.xlsx"))
  
# loading of data downloaded from server 
data.cons.long = readRDS(paste0(path.to.dat,"/data.cons.Rds"))

# merging datasets together
data.cons.raw = full_join(x = data.cons.from.G,
                           y = data.cons.long, by = "code") %>% 
  mutate(Source = as.factor("Consecrated")) %>% 
  mutate(across(starts_with(c("obtize_","hlth_")), ~ as.numeric(.)))
#............................................................................................

data.cons.raw = data.cons.raw %>% 
  rename(hlth_for_wom_pain_in_the_small_ = hlth_for_women_pain_in_the_small_etc) %>% 
  mutate(across(starts_with("obtize_"), ~ dplyr::recode(.,
                                                "1" = "Not many times per week",
                                                "2" = "Not many times per week",
                                                "3" = "Not many times per week",
                                                "4" = "Many times a week",
                                                "5" = "Many times a week"))) %>% 
  mutate(across(starts_with(c("hlth_","OASIS_","ODSIS_","religious_age")), ~ as.numeric(.))) %>% 
    mutate(Education = recode_factor(Education, 
                                   "Basic school" = "Basic school", 
                                   "Vocational school or non - maturity high school" = "Vocational school or non - maturity high school",
                                   "High school" = "High school",
                                   "Higher vocational school" = "Higher vocational school or University",
                                   "University bachelor" = "Higher vocational school or University",
                                   "University master" = "Higher vocational school or University",
                                   "University Dr" = "Higher vocational school or University",
                                   "other: Ph.D." = "Higher vocational school or University",
                                   "other: Mgr, Bc." = "Higher vocational school or University",
                                   "other: PhD." =  "Higher vocational school or University",
                                   "other: ThLic" =  "Higher vocational school or University",
                                   "other: vysokoškolské licenciatne" =  "Higher vocational school or University",
                                   "other: ošetrovatelský kurz" = "Higher vocational school or University",
                                   "other: PhD. " = "Higher vocational school or University",
                                   .default = NA_character_)) %>% 
  mutate_if(is.factor, droplevels)
  
  
  # removing speeders
data.cons.raw.hq = data.cons.raw %>% 
  filter(low_q_res == "HQ")

# removing Slovak participants
data.cons.cz = data.cons.raw.hq %>% 
  filter(country == "CZ")

# removing Czech participants
data.cons.sk = data.cons.raw.hq %>% 
  filter(country == "SK")

# removal of dupicites - no duplicites in Czech participants
data.cons.dups.rem = data.cons.raw.hq %>% 
  select(!"age") %>% 
  filter(duplicities == "0")

# removal of participants not being neither Czech or Slovak nationality
data.cons = data.cons.dups.rem %>% 
  filter(country %in% c("SK","CZ"))
  
  data.cons = data.cons %>% 
  mutate(OASIS = rowSums(across(starts_with("OASIS_")))) %>% 
  mutate(ODSIS = rowSums(across(starts_with("ODSIS_")))) %>% 
  select(starts_with(c("Gender",
  "Education","Age",
  "Economical_status" ,
  "hlth_ICHS",
"hlth_chronic_lung_disease",
"hlth_diabetes", 
"hlth_astma" ,
"hlth_arthritis",
"hlth_back_pain", 
"hlth_allergy",
"hlth_depression_anxiety",
"hlth_obesity", 
"hlth_gastric_or_duodenal_ulcers",
"hlth_thyroid_disease",
"hlth_hypertension",
"hlth_migraine",
"hlth_skin_diseases_eczema",
"hlth_ICHS",
"hlth_stroke", 
"hlth_for_wom_pain_in_the_small_", 
"hlth_pain_of_unclear_origin",
"hlth_cancer",
"obtize_1a", "obtize_2a", "obtize_3a", "obtize_4a", "obtize_5a", 
"obtize_6a", "obtize_7a", "obtize_8a", "obtize_9a", "obtize_10a", "obtize_11a", "obtize_12a",
"daily_energy","country",
"psychotherapy",
"OASIS","ODSIS","code","religious_age","code","Source"))) %>% 
  select(!starts_with(c("education.x","education.y","religious_age.x")))

# sum of all diseases
data.cons = data.cons %>% 
  mutate(General_health = rowSums(across(starts_with(c("hlth_")))))

per.male_female.s4=table(data.cons$Gender)/length(data.cons$Gender) 

#...............................................................
# just basic descriptive
#...............................................................
# data.cons.raw %>% select(starts_with("OASIS_")) %>% describe()
# data.cons.raw %>% select(starts_with("ODSIS_")) %>% describe()
```
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- Data screening CONCECRATED dataset 2016----->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
```{r outliers screening and inconsistent responding detection cons, include=FALSE}
out_MAD.OA.cons=outliers_mad(data.cons$OASIS, b = 1.4826,threshold = 2.5, na.rm = T) 
out_MAD.OD.cons=outliers_mad(data.cons$ODSIS, b = 1.4826,threshold = 2.5, na.rm = T) 

# creating dataset only with outliers for screening purposes
# data.cons %>% filter(OASIS %in% out_MAD.OA.cons$outliers) %>% view()
# data.cons %>% filter(ODSIS %in% out_MAD.OD.cons$outliers) %>% view()
```

```{r missing data analysis cons, eval=FALSE, include=FALSE}
MCAR.cons.data.mis.mech=MissMech::TestMCARNormality(data = select(.data = data.cons, starts_with(c("OASIS_","ODSIS_",
                                                                                                 "hlth_","Age",
                                                                                                 "daily_energy",
                                                                                                 "psychotherapy",
                                                                                                 "religious_age"))))
```

```{r multivariate normality cons, include=FALSE}
# MULTIVARIATE NORMALITY:
# mvn(data = select(.data = data.cons, starts_with(c("OASIS","ODSIS", "obtize_","hlth_","Age","religious_age"))), mvnTest = "mardia", univariatePlot = "histogram")
# inspection indicated skewness problems with items: 
Mard=mvn(data= select(.data = data.cons, starts_with(c("OASIS","ODSIS",
                             "hlth_","Age","religious_age"))),mvnTest = "mardia")    

# summary: # in both datasets, normality in OASIS and ODSIS cen be rejectd
```

```{r Homoscedasticity_and_other_assumptions cons, include=FALSE}
# fake regression 
random=rchisq(nrow(data.cons), 7) # generate random data
fake_regres=lm(random~., data= data.cons %>% select(starts_with(c("OASIS","ODSIS","obtize_",
                             "hlth_","Age","religious_age")))) # run fake regression
# run diagnostics plots 
plot(fake_regres)
# testing homogenity of variances
lmtest::bptest(fake_regres) # homogenity of variances can be assumed 
```

# Introduction
Persons who consecrated themselves through their lifelong commitment to God and to a certain religious institute represent a minority group belonging mostly to the Roman Catholic Church [@holtz2006geschichte;@frank1988geschichte]. This group differs from the major society in more aspects and its way of life arouses many questions [@cist2019living;@elias2019monasticism]. To the main specifics of living in a religious institute belong the fundamental role of spirituality [@bussing2017validation] and religiosity [@quartier2017monastic], the hierarchical structured community and subordination to the authority, the binding statutes and daily routine [@wrobel2018duties;@fernandez2019convents], gender uniformity and resignation on sexual relationships and family life [@huel2018missionaries]. Expected is also a high level of social engagement [@bickerton2013spiritual] as well as a certain social isolation and/or self-excluding from the mainstream [@jewdokimow2019transcending;@meawad2020sexuality]. Catholic order members can be regarded as a homogenous population with a number of common characteristics on individual and socioeconomic level [@bowen2018community].  
Research on health among consecrated people (CP) attracts some attention, but the studies are sparse and rather ambiguous. The majority of the existing studies brings positive conclusions. The religious order members were reported to be at lower risk of mental health disorders [@rogowska2020investigating], more successful in achieving physical and mental well-being [@corwin2014lord] and able to care systematically for their health [@huck1996health]. The prevalence of positive emotions was observed among the nuns [@skrzypinska2012intricacies] as well as a higher level of personal happiness [@francis2018happiness] and satisfaction at work engagement [@ariza2018work] together with lower tendence to professional burnout [@chirico2020spirituality]. Several studies chose the religious communities as a sample of people living a meaningful and cognitive stimulating life and came to the results of lower risk of Alzheimer disease or dementia among them [@keohane2019nun;@schott2019stability]. It corresponds to the findings about higher ability of consecrated persons to age meaningfully [@corwin2020care] and about their longevity [@weinstein2019autonomous;@danner2001positive].
On the contrary, a few studies point at some deficits in the health practises of religious order members [@meurer1990exploratory]. These deficits can include a danger of exhausting the spiritual resources through excessive work engagement [@bickerton2013spiritual] or an impact of community conflicts on the health of individuals [@bowen2018community]. Furthermore, because the daily routine of the religious communities is usually strongly oriented to getting up early and going to bed early without considering individual chronotype, we also suppose persons with a late circadian timing, the so called “night owls”, being in some measure handicapped by this regime. As opposite to the “larks” with an early circadian timing, “night owls” prefer to stay up and to work long in the evening and have problems to wake up and to be active early in the morning [@facer2019resetting]. “Night owls” living in a religious community with a structured daily routine might suffer from lack of sleep, which might have a negative impact on their health [@duns2019sleep].
However, the existing results cannot be fully generalized, because there is a need of more data from different countries and social-political contexts. So far, most of the previous research studies were carried out in the USA, some of them in Poland, Germany and Italy. In all these countries, in spite of the advanced secularisation in some of them, the presence and the social engagement of religious institutes have an established tradition and a high level of public credit, which seems to play an important role [@rogowska2020investigating]. On the contrary, data from secular post-communist countries are missing, as well as data from African, Asian or South American communities. We presume there is also some other bias to consider, such as a high level of social desirability and non-representative samples because all community members rarely complete the voluntary questionnaires and the healthier and more active persons are more likely to participate.
The current study examines the general health characteristics of religious brothers and sisters in former Czechoslovakia compared to control samples of the Czech population. As the country with the highest percentage (76,4%) of religiously unaffiliated people in the world (Pew Research Center 2014), the Czech Republic (CZ) represents a not very supportive milieu towards the Roman Catholic Church and religious institutes. Slovakia (SK) belongs traditionally to the Catholic countries (62% Roman Catholics and 13,4% atheists in the 2011 census) and the consecrated persons are more numerous and more appreciated than in the Czech Republic. Nevertheless, the modern history of these two countries is firmly connected and the convents and monasteries in both of them are still carrying the consequences of the long persecution, overworking and forced isolation during the communist regime. Compared to the previous studies, given these facts, we may expect a higher level of adverse health affecting factors and lower scores of well-being and life satisfaction among the members of the Czech and Slovak religious communities, presuming some slight differences between the Czechs and Slovaks.
Therefore, the aim of this study is to explore the possible associations between membership in a convent or monastery religious community in two post-communist countries and the general health characteristics of the individuals. Further, we will assess if the individual chronotype can play some role in health of consecrated persons.

# Methods

## Measures

### Health complaints
  The frequency of recent health complaints was assessed by the 6-item measure: headache, stomachache, backache, intestinal problems, trouble falling asleep, dizziness. The question was: “In the past month, how often have you had the following issues?“ Each item was answered on a five-point scale: never (1), about once or twice (2), approximately once a week (3), more than once a week (4), every day (5).  For analytical purposes, participants responses were dichotomised. Answers ranging from  1: "never" up to 3: "approximately once a week" were recoded as "Not many times per week" and answers ranging from 4: "More than once a week" up to 5: "every day" were recoded as "Many times a week".
  
### Long lasting illnesses
  For the occurrence of chronic illnesses, an 18-item measure was used introduced by the question: “Do you have a long-term illness or disability? Please tick all that apply to you.“ The illnesses are listed in Table 2.
  
### General health
  The general health was assessed by composite variable created by summing up the number of chronic illnesses. This variable was consequently divided into several categories based on the following approach: having < 1 disease was classified as “no diseases”, 1-2 diseases was classified as “few diseases” 3-5 diseases as “several diseases” and more than 6 as “many diseases”.
  
### Chronotype 
  The daily energy was measured by choosing between two possibilities – “an early bird” (or “lark”) who wakes up early but is tired in the evening, or “a night owl” who has problem with waking up early but enjoys working in the evening.


## Participants
   
### Sample one
  First sample (*n* = `r nrow(data.rep)`, Age: *M* = `r mean(data.rep$Age, na.rm = T) %>% round(digits = 2)`, *SD* = `r sd(data.rep$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s1[["Female"]]*100,digits = 2)`%) consisted of participants from Czech nationally representative sample of the study on health, life experience, attitudes and lifestyle collected in 2016 [@malinakova2020religiosity]. In this dataset we did not find subjects responding incongruently to the control items i.e. feeling the God presence despite being non-religious or atheist. Thus, no participant was excluded from the dataset.

### Sample two
   The second sample was collected in April 2020. It was a survey made in the Czech population during the first Covid 19-lockdown. From the original dataset (*n* = `r nrow(data.pa.raw)`), we excluded `r nrow(data.pa.raw)-nrow(data.pa.hq)` participants who responded incongruently to 3 repeatedly asked questions and those, who were speeders i.e. time spent on filling the questionnaire was < 10 min. The three control questions included age (difference > 2 years), weight and height (difference > 2 kilogram and centimetres). Hence, the number of participants was `r nrow(data.pa.out)`. Based on the results of outliers screening procedure (see statistical analysis section), we also removed subjects, which responded to large number of questions in the same way (*n* = `r length(pa.cod.rem)`). Therefore, the final number of participants was `r nrow(data.pa)` (Age: *M* = `r mean(data.pa$Age, na.rm = T) %>% round(digits = 2)`, *SD* = `r sd(data.pa$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s2[["Female"]]*100,digits = 2)`%).

### Sample three
A sample of Catholic order members in the Czech Republic and in the Slovak Republic was recruited to take part in a survey regarding various aspects of today´s consecrated life. The respondents were recruited by contacting the major superiors of all male and female religious institutes in both countries. After six weeks, the information about the survey was sent directly into the local communities in order to increase the number of respondents. The research was done under the auspices of the Conference of Major Religious Superiors of the Czech and Slovak Republic. The superiors were asked to spread an online or a paper-and-pencil questionnaire among the members of their communities and to support its completing. Data was collected from March to May 2021.
  This sample initially consisted of `r nrow(data.cons.raw)` participants. In the first step, we excluded participants (n = `r nrow(data.cons.raw) - nrow(data.cons.raw.hq)`) who were classified as speeders i.e. finished questionnaire typically lasting more than 30 minutes in < 10 minutes. After this exclusion, `r nrow(data.cons.raw.hq)` participants remained. We also removed participants who filled questionnaire multiple times (*n* = `r nrow(data.cons.raw.hq) -  nrow(filter(data.cons.raw.hq, duplicities == "0"))`) resulting in (n = `r nrow(data.cons.dups.rem)`) of subjects . This sample consisted of `r nrow(data.cons.cz)` Czech participants and `r nrow(data.cons.sk)` Slovak participants. Other than Czech and Slovak participants were excluded (n = `r nrow(data.cons.dups.rem)-nrow(data.cons)`) resulting in `r nrow(data.cons)` subjects (Age: M = `r mean(data.cons$Age, na.rm = T) %>% round(digits = 2)`, SD = `r sd(data.cons$Age, na.rm = T) %>% round(digits = 2)`, Females: `r round(per.male_female.s4[["Female"]]*100,digits = 2)`%). No uniform pattern of responding was detected in this sample. The mean duration of being part of a religious community was `r round(mean(data.cons$religious_age.y,na.rm = T),digits = 2)`.

## Statistical analysis
  As suggested by Shapiro-Wilk test and by histograms, normality assumption was broken in all samples. Thus, non - parametric methods were used. Homogenity of variances was equal in all samples as indicated by the Breusch-Pagan test. As the null hypotheses of the MCAR test in all our surveys was not rejected, we deleted missing values listwise. Outliers were explored by the Median Absolute Deviation (MAD). Outliers identified by the MAD were consequently screened and if there were signs of uniform pattern of responding, i.e. answering the number of items in the same manner, outliers were removed from the dataset.

  To explore the differences in health status among CP and non-CP, we compared long lasting illnesses of CP to chronic illnesses of participants from representative sample in logistic regres-sion models. In these models, long lasting illnesses were set as dependent variables. Grouping variable distinguishing CP from non-CP was a regressor. Covariates consisted of gender, educa-tion and age. Ordinal logistic regression was used to compare CP and non-CP in the general health. The same regression type was applied to explore associations between the chronotype and general health in CP. In the ordinal regression models, the following variables were controlled: age, education, gender and length of life in a religious institute. The Brant test indicated, that pro-portional odds assumption held for each of the ordinal regression models. Variance inflation fac-tor (VIF) was used to assess multicolinearity in all regression models. The VIF values < 10 indicat-ed an acceptable degree of association between variables [@TAY2017]. Bonferroni correction was used to correct p-values in all regression models. When the significnance was lost after correction, we used the term "trends" to describe relationships after the correction. The `r cite_r()` was utilized for all analysis.

# Results

```{r merge of the datasets and soc-dem compar, echo=FALSE, message=FALSE, warning=FALSE}
data = bind_rows(data.rep, 
                 data.pa,
                 data.cons)

# data %>%
# ggplot(aes(x=Source,
#              y = ..prop..,
#              group = hlth_depression_anxiety,
#              fill = hlth_depression_anxiety)) +
#   geom_bar(position = 'dodge') +
#   geom_text(stat='count',
#             aes(label = scales::percent(..prop..)),
#             vjust=-1,
#             position = position_dodge(width = 1)) +
#   ylab(NULL) +
#   ylim(0,.80) +
#   theme(axis.title.y=element_blank(),
#         axis.text.y=element_blank(),
#         axis.ticks.y=element_blank())

#dunn.test(data$General_health, data$Source, list = T, altp = T, method = "bonferroni", kw=T, label = T, table = T)
# kruskal.test(General_health ~ Source, data = data) 
# aov(General_health ~ Source, data = data) %>% TukeyHSD()
```

The table 1 depicts the basic socio-demographic characteristics of the study samples.

\newpage

```{r socio-demographic table, echo=FALSE}

cs.tab.1=data.rep %>%
  dplyr::select(Gender, Family_status , Education, Economical_status, Faith) %>%
  tbl_summary( missing = "no",
                  statistic = list(all_continuous() ~  "{mean}({sd})",
                                   all_categorical() ~ "{n} ({p}%)"),
              digits = all_continuous() ~ 2,) 

cs.tab.2=data.pa %>%
  dplyr::select(Gender, Family_status , Education, Economical_status) %>%
  tbl_summary( missing = "no",
                  statistic = list(all_continuous() ~  "{mean}({sd})",
                                   all_categorical() ~ "{n} ({p}%)"),
              digits = all_continuous() ~ 2,) 

cs.tab.3=data.cons %>%
  dplyr::select(Gender, Education, ) %>%
  tbl_summary( missing = "no",
                  statistic = list(all_continuous() ~  "{mean}({sd})",
                                   all_categorical() ~ "{n} ({p}%)"),
              digits = all_continuous() ~ 2,) 
#[......................................................................]
tbl_merge(tbls = list(cs.tab.1, cs.tab.2,cs.tab.3),
          tab_spanner = c("**Sample 1**",
                          "**Sample 2**",
                          "**Sample 3 (CZ,SK)**")) %>%
    modify_footnote(update = everything() ~ NA) %>% 
  modify_caption("Socio-demographic table") %>% 
  as_kable_extra(format = "latex",
                 booktabs = TRUE) %>% 
  kableExtra::kable_styling(latex_options = "scale_down")
```

\newpage

## Chronic illness differences
  In Table 2, prevalence   of chronic diseases among the study samples can be found. Table 3 presents differences in chronic diseases between consecrated persons and the representative sample. It was revealed that there is a significant positive relationship between being a consecrated person and a lower probability of suffering from diabetes in crude effect. However, there was a positive relationship between being a consecrated person and a higher chance of obesity in crude and ad-justed effect, pain in the small pelvis in both crude and adjusted effect and thyroid disease in crude and adjusted effect. After Bonferroni correction, thyroid disease was non-significant.

<!-- Chronic illnesses -->
```{r frist regression, include=FALSE}
# Side-by-side Regression Models
# logistic regression model
# we have 34 analysis thus 0.05/34 = 0.001470588 = criterion P-value

# data$Source = relevel(data$Source, ref = "Less than once a week")

data.reg = data %>% 
  mutate(across(starts_with("hlth_"), ~dplyr::recode_factor(.,
                                                     "0" = "no",
                                                     "1" = "yes"))) %>% 
  filter(Source %in% (c("Representative","Consecrated"))) %>% 
    mutate(across(starts_with("Source"), ~dplyr::recode_factor(.,
                                                     "Representative" = "Representative",
                                                     "Consecrated" = "Consecrated"))) %>%
  mutate_if(is.factor, droplevels) %>% 
  filter(country %in% "CZ" |
           country %in% "SK" |
           Source %in% "Representative")

ra.b.1 <-
  glm(hlth_hypertension ~ Source + Age + Education  + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Hypertension")) %>%
  bold_p(t = 0.001388889) 
#...... assumptions.......  # THERE IS NO NEED TO EXPLORE VIF IN THE REST OF THE MODELS HERE ONLY IN THE FIST ONE. THIS IS BECAUSE THE VALUES ARE THE SAME IN THE REST OF THE MODELS IN THIS CHUNK. 
#.........................
lm(as.numeric(hlth_hypertension)  ~ Source + Age + Education  + Gender, data = data.reg) %>%
  car::vif() # VIF has  adequate values
#.........................
# variable religious age is causing the problem which is understandable regarding the fact that all values in the representative sample are 0 (replaced NAs) and all values in sample 4 are > 1 given that all are clerics. This manual insertion of "0" value to all participants in representative sample seems not to be adequate reference level to which variable religious age in sample 4 should be compared with. One of the reasons is that we can not deny that there are are no clerics (even a very few) in the representative sample. Code illustrating the problem can be found in the script called Multicolineairty.    
#.........................
ra.b.2 <-
  glm(hlth_hypertension ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Hypertension")) %>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.3 <-
  glm(hlth_diabetes ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Diabetes"))%>%
  bold_p(t = 0.001388889) 
ra.b.4 <-
  glm(hlth_diabetes ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Diabetes"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.5 <-
  glm(hlth_arthritis ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Arthritis"))%>%
  bold_p(t = 0.001388889) 
ra.b.6 <-
  glm(hlth_arthritis ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Arthritis"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.7 <-
  glm(hlth_astma ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Astma"))%>%
  bold_p(t = 0.001388889) 
ra.b.8 <-
  glm(hlth_astma ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Astma"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.9 <-
  glm(hlth_depression_anxiety ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Depression/Anxiety"))%>%
  bold_p(t = 0.001388889) 
ra.b.10 <-
  glm(hlth_depression_anxiety ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Depression/Anxiety"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.11 <-
  glm(hlth_ICHS ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Ischemic heart disease"))%>%
  bold_p(t = 0.001388889) 
ra.b.12 <-
  glm(hlth_ICHS ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Ischemic heart disease"))%>%
  bold_p(t = 0.001388889)
#_____________________________________________________________
ra.b.13 <-
  glm(hlth_obesity ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Obesity"))%>%
  bold_p(t = 0.001388889) 
ra.b.14 <-
  glm(hlth_obesity ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Obesity"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.15 <-
  glm(hlth_stroke ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Stroke"))%>%
  bold_p(t = 0.001388889) 
ra.b.16 <-
  glm(hlth_stroke ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Stroke"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________

ra.b.17 <-
  glm(hlth_back_pain ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Back pain"))%>%
  bold_p(t = 0.001388889) 
ra.b.18 <-
  glm(hlth_back_pain ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Back pain"))%>%
  bold_p(t = 0.001388889) 
#___________________________________________________________________________________________________________________
ra.b.19 <-
  glm(hlth_gastric_or_duodenal_ulcers ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Gastric or duodenal ulcers"))%>%
  bold_p(t = 0.001388889) 
ra.b.20 <-
  glm(hlth_gastric_or_duodenal_ulcers ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Gastric or duodenal ulcers"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.21 <-
  glm(hlth_chronic_lung_disease ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Chronic lung disease"))%>%
  bold_p(t = 0.001388889) 
ra.b.22 <-
  glm(hlth_chronic_lung_disease ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Chronic lung disease"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.23 <-
  glm(hlth_skin_diseases_eczema ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Skin diseases eczema"))%>%
  bold_p(t = 0.001388889) 
ra.b.24 <-
  glm(hlth_skin_diseases_eczema ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Skin diseases eczema"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.25 <-
  glm(hlth_allergy ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Allergy"))%>%
  bold_p(t = 0.001388889) 
ra.b.26 <-
  glm(hlth_allergy ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Allergy"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.27 <-
  glm(hlth_migraine ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Migraine"))%>%
  bold_p(t = 0.001388889) 
ra.b.28 <-
  glm(hlth_migraine ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Migraine"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.29 <-
  glm(hlth_pain_of_unclear_origin ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Pain of unclear origin"))%>%
  bold_p(t = 0.001388889) 
ra.b.30 <-
  glm(hlth_pain_of_unclear_origin ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Pain of unclear origin"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.31 <-
  glm(hlth_for_wom_pain_in_the_small_ ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Pain in the small pelvis"))%>%
  bold_p(t = 0.001388889) 

ra.b.32 <-
  glm(hlth_for_wom_pain_in_the_small_ ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Pain in the small pelvis"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.33 <-
  glm(hlth_cancer ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Cancer"))%>%
  bold_p(t = 0.001388889) 
ra.b.34 <-
  glm(hlth_cancer ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Cancer"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________
ra.b.35 <-
  glm(hlth_thyroid_disease ~ Source + Age + Education + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Thyroid disease"))%>%
  bold_p(t = 0.001388889) 
ra.b.36 <-
  glm(hlth_thyroid_disease ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Thyroid disease"))%>%
  bold_p(t = 0.001388889) 
#_____________________________________________________________

ra.b.tab.pok1=tbl_stack(
  tbls = list(ra.b.1,
              ra.b.3,
              ra.b.5,
              ra.b.7,
              ra.b.9,
              ra.b.11,
              ra.b.13,
              ra.b.15,
              ra.b.17,
              ra.b.19,
              ra.b.21,
              ra.b.23,
              ra.b.25,
              ra.b.27,
              ra.b.29,
              ra.b.31,
              ra.b.33,
              ra.b.35)) %>% 
   modify_header(label = "**Table 2**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 
# printing merged table
ra.b.tab.pok2=tbl_stack(
  tbls = list(ra.b.2,
              ra.b.4,
              ra.b.6,
              ra.b.8,
              ra.b.10,
              ra.b.12,
              ra.b.14,
              ra.b.16,
              ra.b.18,
              ra.b.20,
              ra.b.22,
              ra.b.24,
              ra.b.26,
              ra.b.28,
              ra.b.30,
              ra.b.32,
              ra.b.34,
              ra.b.36)) %>% 
   modify_header(label = "**Table 2.1**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 

ra.b.t1=tbl_merge(
tbls = list(ra.b.tab.pok1,ra.b.tab.pok2),
tab_span = c("**ADJ(ra)**", "**NA(ra)**"))
```

```{r convert gtsum tab into tible, include=FALSE}
table.2=ra.b.t1

#show_header_names(table.2)
# if there is need to use this code in the some other research there is need to just replace the names of the columns (e.g. `95% CI_(RA)` by " `95% CI_(EMP)`) and delete or add the number of OR,p-val,CI columns

  # convert to tibble object
  table.2.tib= table.2 %>% as_tibble()
  
  # setting names
names.tab2=c("Table 2",
             "OR_(R)","95% CI_(R)","p-value_(R)", # the first names are crude and second for adjusted effect
             "OR_(Rna)","95% CI_(Rna)","p-value_(Rna)")

table.2 = expss::setnames(x = table.2.tib, new = names.tab2)

  
   #ds=gtsummary::as_tibble(re.tab.1)
   table.2.tib.star = table.2.tib %>%
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '^>', ""))) %>%
   dplyr::mutate(TF_P=across(dplyr::contains("p-val"), ~str_detect(., pattern = "_"))) %>% 
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '__', ""))) %>% 
   dplyr::mutate(stars = across(dplyr::contains("p-val"), ~pander::add.significance.stars(., cutoffs = c(0.05, 0.01, 0.001))))
   table.2.tib.star = table.2.tib.star %>% 
   dplyr::mutate_at(dplyr::vars("OR_(R)"), ~paste0(., c(table.2.tib.star$stars$`p-value_(R)`))) %>%  # if more p value is present there is need add more rows here 
   dplyr::mutate_at(dplyr::vars("OR_(Rna)"), ~paste0(., c(table.2.tib.star$stars$`p-value_(Rna)`))) %>%  
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., " ", ""))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\*+", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+", NA_character_))) 
   # if command is not working there is need to remove in the last commant the ""sta"" column
  
      # creating the new column containing only: OR 95%CI(xx-xx)
    table.2.tib.star = table.2.tib.star %>% 
     mutate(cis1 = paste0('(',table.2.tib.star$`95% CI_(R)`,')'), 
            cis2 = paste0('(',table.2.tib.star$`95% CI_(Rna)`,')'))
    # replacing old columns
    table.2.tib.star = table.2.tib.star %>% 
      mutate(`OR_(R)`=paste(table.2.tib.star$`OR_(R)`, cis1, sep=" "),
             `OR_(Rna)`=paste(table.2.tib.star$`OR_(Rna)`, cis2, sep=" "))
    
    # deleting undesired symbols
    table.2.tib.star = table.2.tib.star %>% 
      select(dplyr::contains(c("Table","OR","TF"))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\[ ]+", " "))) 
    # Adding prefix to corrected values
      # table.2.tib.star = table.2.tib.star %>% 
      # mutate(`OR_(R)` = case_when(table.2.tib.star$TF_P$`p-value_(R)` == "TRUE" ~ paste0("B", sep = "_", `OR_(R)`), 
      #                    TRUE ~ `OR_(R)`),
      #        `OR_(Rna)`= case_when(table.2.tib.star$TF_P$`p-value_(Rna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(Rna)`), 
      #                    TRUE ~ `OR_(Rna)`),
      #         `OR_(RA)`= case_when(table.2.tib.star$TF_P$`p-value_(RA)` == "TRUE" ~ paste0("B", sep = "_",  `OR_(RA)`), 
      #                    TRUE ~ `OR_(RA)`),
      #         `OR_(RAna)` = case_when(table.2.tib.star$TF_P$`p-value_(RAna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(RAna)`), 
      #                    TRUE ~  `OR_(RAna)`))
      
     # selecting only relevant columns
         table.2.tib.star = table.2.tib.star %>% 
          mutate(across(dplyr::contains("OR_"), ~str_replace_all(., "\\[+", " ["))) %>% 
            select(!dplyr::starts_with("TF_P")) %>% 
           tibble::add_row(.after = "Day structure") %>%  # there is need to add as much rows as is the number of rows in second part of the table 
          mutate("Crude effect" = "") %>%  
           mutate("Adjusted effect" = "") %>% 
          select(`Table 2`, "Crude effect", `OR_(Rna)`, "Adjusted effect", `OR_(R)`) %>%    # changing the position of crude effect 
             mutate_all( ~(na_if(., ""))) %>%
           janitor::remove_empty(which = c("cols")) %>% 
           rename("Crude effect" = `OR_(Rna)`,
                  "Adjusted effect" = `OR_(R)`)
         
      # transposing table 
         # convert to wider format
       tab.wide.1 = table.2.tib.star %>%
         t()
```

```{r preparation to print tab, message=FALSE, warning=FALSE, include=FALSE}

# the only step here which is required here is to manually divide dataset into four parts and then rbind these togather 

# even a little bit wider
# tab.wide.1 %>% ncol()

tr.1=tab.wide.1[,c(16,7,2:3,18)] %>% as_tibble(rownames = NA)
tr.2=tab.wide.1[,c(5,14,15,17)] %>% as_tibble(rownames = NA)         
tr.3=tab.wide.1[,c(1,6,8,9,19)] %>% as_tibble(rownames = NA)
tr.4=tab.wide.1[,c(10:12,13)] %>% as_tibble(rownames = NA) 
         
         tab = bind_rows(tr.1,tr.2,tr.3,tr.4)
         tab = tab %>% 
           as_tibble(rownames = NA) %>% 
           rownames_to_column()  %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "\\.+\\.+\\.+[[:digit:]]+", replacement = ""))) %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "Table 2", replacement = ""))) %>% 
           mutate_all(~(replace(., is.na(.), ""))) %>%
           janitor::row_to_names(row_number = 1) 
```

```{r prevalence table, echo=FALSE, message=FALSE, warning=FALSE}
# in the variable source there is need to cut "Consecrated" groups into Czech and Slovak participants
vars.prev.tab = data %>% 
  mutate(sec_Source = as.numeric(Source)) %>%
  mutate(sec_Source = dplyr::recode(sec_Source,
                                    "1" = "Sample 1",
                                    "2" = "Sample 2",
                                    "3" = "Sample 3"))
 
# renaming of the variables to be included in the table 

vars.prev.tab = vars.prev.tab %>% 
  select(starts_with(c("sec_Source","hlth_","General_"))) %>% 
  rename(
"ICHS" = "hlth_ICHS",
"Chronic lung disease" = "hlth_chronic_lung_disease",
"Diabetes" = "hlth_diabetes",
"Astma" = "hlth_astma", 
"Back pain" = "hlth_back_pain",
"Arthritis" = "hlth_arthritis",
"Allergy" = "hlth_allergy", 
"Depression/Anxiety" = "hlth_depression_anxiety", 
"Obesity" = "hlth_obesity", 
"Gastric or duodenal ulcers" = "hlth_gastric_or_duodenal_ulcers",
"Thyroid disease" = "hlth_thyroid_disease",
"Hypertension" = "hlth_hypertension", 
"Migraine" = "hlth_migraine",
"Skin diseases eczema" = "hlth_skin_diseases_eczema",
"Stroke" = "hlth_stroke",
"Pain in the small pelvis" = "hlth_for_wom_pain_in_the_small_",
"Pain of unclear origin" = "hlth_pain_of_unclear_origin",
"Cancer" = "hlth_cancer")

# rename_all(~str_replace_all(., "hlth_", " "))
    
vars.prev.tab  %>% 
  tbl_summary(by = sec_Source, missing = "no",
  statistic = list(all_continuous() ~  "{mean} ({sd})",
                                   all_categorical() ~ "{n} ({p}%)"),
              digits = all_continuous() ~ 2) %>% 
  modify_footnote(update = everything() ~ "ICHS = Ischemic heart disease, In the General helath variable, values refers to M(SD)") %>%
  modify_caption("General health and chronic ilnesses among study samples") %>% 
  as_kable_extra(format = "latex",
                 booktabs = TRUE) %>% 
  kableExtra::kable_styling(latex_options = c("hold_position","scale_down"),
                            font_size = 8,
                            position = "center") 
```

$$\\[1in]$$

```{r Print regres tab 1, echo=FALSE, message=FALSE, warning=FALSE}
  knitr::kable(tab, "latex", booktabs=T, linesep = "", caption = "Depicts associations (in Odds rations) between living in clerical life and chronic deseases (Sample 1 and 3)") %>%
  kableExtra::kable_styling(latex_options = c("scale_down","hold_position"),   font_size = 7) %>%  # full_width = T or longtable = T (to the Kable command)
  kableExtra::footnote(general = c("p < 0.05 *, p < 0.01 ** p < 0.001 ***, Adjusted effect was calculated using the following variables as a covariates: Age, Gender and Education. Values in brackets indicates 95% confidence interval. After Bonferroni correction, the first three results in the first row remained significant. Other relationships were non-significant."), general_title = "Note:", title_format = c("italic"), threeparttable=T, footnote_as_chunk = T)
```
<!-- Prevalence table -->

<!-- Health complains -->
```{r health complains table, include=FALSE}
# Side-by-side Regression Models
# logistic regression model
# we have 52 analysis in total thus 0.05/52 = 0.0009615385 = criterion P-value

data.reg.2 = data %>% 
  mutate(across(starts_with("obtize_"), ~dplyr::recode_factor(.,
                                                     "Not many times per week" = "Not many times per week",
                                                     "Many times a week" = "Many times a week", .ordered = T))) %>% 
  filter(Source %in% (c("Panel","Consecrated"))) %>% 
    mutate(across(starts_with("Source"), ~dplyr::recode_factor(.,
                                                     "Panel" = "Panel",
                                                     "Consecrated" = "Consecrated"))) %>%
  mutate_if(is.factor, droplevels) %>% 
  filter(country %in% "CZ" |
           country %in% "SK" |
           Source %in% "Panel")

#...... assumptions.......  # THERE IS NO NEED TO EXPLORE VIF IN THE REST OF THE MODELS HERE ONLY IN THE FIST ONE. THIS IS BECAUSE THE VALUES ARE THE SAME IN THE REST OF THE MODELS IN THIS CHUNK. 
#.........................
lm(as.numeric(obtize_1a)  ~ Source + Age + Education  + Gender, data = data.reg.2) %>%
  car::vif() # VIF has  adequate values
#.........................

ra.b.1 <-
  glm(obtize_1a ~ Source + Age + Education  + Gender, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Headache")) %>%
  bold_p(t = 0.0009615385) 
ra.b.2 <-
  glm(obtize_1a ~ Source, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Headache")) %>%
  bold_p(t = 0.0009615385) 
#_____________________________________________________________
ra.b.3 <-
  glm(obtize_2a ~ Source + Age + Education + Gender, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Stomachache"))%>%
  bold_p(t = 0.0009615385) 
ra.b.4 <-
  glm(obtize_2a ~ Source, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Stomachache"))%>%
  bold_p(t = 0.0009615385) 
#_____________________________________________________________
ra.b.5 <-
  glm(obtize_3a ~ Source + Age + Education + Gender, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Backache"))%>%
  bold_p(t = 0.0009615385) 
ra.b.6 <-
  glm(obtize_3a ~ Source, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Backache"))%>%
  bold_p(t = 0.0009615385) 
#_____________________________________________________________
ra.b.7 <-
  glm(obtize_4a ~ Source + Age + Education + Gender, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Intestinal problems"))%>%
  bold_p(t = 0.0009615385) 
ra.b.8 <-
  glm(obtize_4a ~ Source, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Intestinal problems"))%>%
  bold_p(t = 0.0009615385) 
#_____________________________________________________________
ra.b.15 <-
  glm(obtize_8a ~ Source + Age + Education + Gender, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Trouble falling asleep"))%>%
  bold_p(t = 0.0009615385) 
ra.b.16 <-
  glm(obtize_8a ~ Source, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Trouble falling asleep"))%>%
  bold_p(t = 0.0009615385) 
#_____________________________________________________________

ra.b.17 <-
  glm(obtize_9a ~ Source + Age + Education + Gender, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Dizziness"))%>%
  bold_p(t = 0.0009615385) 
ra.b.18 <-
  glm(obtize_9a ~ Source, family = binomial, data = data.reg.2) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Dizziness"))%>%
  bold_p(t = 0.0009615385) 
#___________________________________________________________________________________________________________________
ra.b.tab.pok1b=tbl_stack(
  tbls = list(ra.b.1,
              ra.b.3,
              ra.b.5,
              ra.b.7,
              ra.b.15,
              ra.b.17)) %>% 
   modify_header(label = "**Table 2**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 
# printing merged table
ra.b.tab.pok2b=tbl_stack(
  tbls = list(ra.b.2,
              ra.b.4,
              ra.b.6,
              ra.b.8,
              ra.b.16,
              ra.b.18)) %>% 
   modify_header(label = "**Table 2.1**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 

ra.b.t2=tbl_merge(
tbls = list(ra.b.tab.pok1b,ra.b.tab.pok2b),
tab_span = c("**ADJ(ra)**", "**NA(ra)**"))
```

```{r convert gtsum tab into tible 2, include=FALSE}
table.3=ra.b.t2

#show_header_names(table.2)
# if there is need to use this code in the some other research there is need to just replace the names of the columns (e.g. `95% CI_(RA)` by " `95% CI_(EMP)`) and delete or add the number of OR,p-val,CI columns

  # convert to tibble object
  table.3.tib= table.3 %>% as_tibble()
  
  # setting names
names.tab3=c("Table 2",
             "OR_(R)","95% CI_(R)","p-value_(R)", # the first names are crude and second for adjusted effect
             "OR_(Rna)","95% CI_(Rna)","p-value_(Rna)")

table.3 = expss::setnames(x = table.3.tib, new = names.tab3)

  
   #ds=gtsummary::as_tibble(re.tab.1)
   table.3.tib.star = table.3.tib %>%
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '^>', ""))) %>%
   dplyr::mutate(TF_P=across(dplyr::contains("p-val"), ~str_detect(., pattern = "_"))) %>% 
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '__', ""))) %>% 
   dplyr::mutate(stars = across(dplyr::contains("p-val"), ~pander::add.significance.stars(., cutoffs = c(0.05, 0.01, 0.001))))
   table.3.tib.star = table.3.tib.star %>% 
   dplyr::mutate_at(dplyr::vars("OR_(R)"), ~paste0(., c(table.3.tib.star$stars$`p-value_(R)`))) %>%  # if more p value is present there is need add more rows here 
   dplyr::mutate_at(dplyr::vars("OR_(Rna)"), ~paste0(., c(table.3.tib.star$stars$`p-value_(Rna)`))) %>%  
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., " ", ""))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\*+", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+", NA_character_))) 
   # if command is not working there is need to remove in the last commant the ""sta"" column
  
      # creating the new column containing only: OR 95%CI(xx-xx)
    table.3.tib.star = table.3.tib.star %>% 
     mutate(cis1 = paste0('(',table.3.tib.star$`95% CI_(R)`,')'), 
            cis2 = paste0('(',table.3.tib.star$`95% CI_(Rna)`,')'))
    # replacing old columns
    table.3.tib.star = table.3.tib.star %>% 
      mutate(`OR_(R)`=paste(table.3.tib.star$`OR_(R)`, cis1, sep=" "),
             `OR_(Rna)`=paste(table.3.tib.star$`OR_(Rna)`, cis2, sep=" "))
    
    # deleting undesired symbols
    table.3.tib.star = table.3.tib.star %>% 
      select(dplyr::contains(c("Table","OR","TF"))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\[ ]+", " "))) 
    # Adding prefix to corrected values
      # table.3.tib.star = table.3.tib.star %>% 
      # mutate(`OR_(R)` = case_when(table.3.tib.star$TF_P$`p-value_(R)` == "TRUE" ~ paste0("B", sep = "_", `OR_(R)`), 
      #                    TRUE ~ `OR_(R)`),
      #        `OR_(Rna)`= case_when(table.3.tib.star$TF_P$`p-value_(Rna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(Rna)`), 
      #                    TRUE ~ `OR_(Rna)`),
      #         `OR_(RA)`= case_when(table.3.tib.star$TF_P$`p-value_(RA)` == "TRUE" ~ paste0("B", sep = "_",  `OR_(RA)`), 
      #                    TRUE ~ `OR_(RA)`),
      #         `OR_(RAna)` = case_when(table.3.tib.star$TF_P$`p-value_(RAna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(RAna)`), 
      #                    TRUE ~  `OR_(RAna)`))
      
     # selecting only relevant columns
         table.3.tib.star = table.3.tib.star %>% 
          mutate(across(dplyr::contains("OR_"), ~str_replace_all(., "\\[+", " ["))) %>% 
            select(!dplyr::starts_with("TF_P")) %>% 
           tibble::add_row(.after = "Day structure") %>%  # there is need to add as much rows as is the number of rows in second part of the table 
          mutate("Crude effect" = "") %>%  
           mutate("Adjusted effect" = "") %>% 
          select(`Table 2`, "Crude effect", `OR_(Rna)`, "Adjusted effect", `OR_(R)`) %>%    # changing the position of crude effect 
             mutate_all( ~(na_if(., ""))) %>%
           janitor::remove_empty(which = c("cols")) %>% 
           rename("Crude effect" = `OR_(Rna)`,
                  "Adjusted effect" = `OR_(R)`)
         
      # transposing table 
         # convert to wider format
       tab.wide.3 = table.3.tib.star %>%
         t()
```

```{r preparation to print tab 2, message=FALSE, warning=FALSE, include=FALSE}

# the only step here which is required here is to manually divide dataset into four parts and then rbind these togather 

# even a little bit wider
# tab.wide.3 %>% ncol()

tr.b.1=tab.wide.3[,c(5,0:2)] %>% as_tibble(rownames = NA)
tr.b.4=tab.wide.3[,c(3,4,6)] %>% as_tibble(rownames = NA)
         
         tab2.b = bind_rows(tr.b.1,tr.b.4)
         tab2.b = tab2.b %>% 
           as_tibble(rownames = NA) %>% 
           rownames_to_column()  %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "\\.+\\.+\\.+[[:digit:]]+", replacement = ""))) %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "Table 2", replacement = ""))) %>% 
           mutate_all(~(replace(., is.na(.), ""))) %>%
           janitor::row_to_names(row_number = 1) 
```
<!-- end HC -->

$$\\[1in]$$

$$\\[1in]$$

## Health complains 
  Table 4 refers to associations between health complains in CP as compared to sample 2. Logistic regression indicated a significant relationship between CP and sleep problems: in crude effect, CP had a lower odds of having trouble falling asleep. No further significant associations were found.

```{r Print regres tab 2, echo=FALSE, message=FALSE, warning=FALSE}
  knitr::kable(tab2.b, "latex", booktabs=T, linesep = "", caption = "Depicts associations (in Odds rations) between living in clerical life and health complains in the last month (Sample 2 and 3)") %>%
  kableExtra::kable_styling(latex_options = c("scale_down","hold_position"),   font_size = 7) %>%  # full_width = T or longtable = T (to the Kable command)
  kableExtra::footnote(general = c("p < 0.05 *, p < 0.01 ** p < 0.001 ***, Adjusted effect was calculated using the following variables as a covariates: Age, Gender and Education. Values in brackets indicates 95% confidence interval."), general_title = "Note:", title_format = c("italic"), threeparttable=T, footnote_as_chunk = T)
```

## General health
```{r chronic ilnessess regression - chronotype, include=FALSE}
# we have 86 analysis thus 0.05/86 = 0.0005813953 = criterion P-value

# data.reg$daily_energy  = relevel(data.reg$daily_energy , ref = "Less than once a week")

data.reg.relig = data %>% 
  mutate(across(starts_with("hlth_"), ~dplyr::recode_factor(.,
                                                     "0" = "no",
                                                     "1" = "yes"))) %>% 
  filter(Source %in% (c("Consecrated"))) %>% 
  mutate_if(is.factor, droplevels) %>% 
  # mutate(religious_age.y = ifelse(is.na(religious_age.y), 0, religious_age.y)) %>% 
  filter(country %in% "CZ" |
           country %in% "SK") %>% 
  rename("Chronotype" = "daily_energy") %>% 
    mutate(cut_General_health = cut(General_health, 
                                  breaks=c(-Inf, 0, 2, 5, Inf), 
                                  labels=c("No","fiew","several","many")))
#_____________________________________________________________
ra.c.1 <-
  clm(cut_General_health ~ Chronotype + Age + Education  + Gender + religious_age.y, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Hypertension")) %>%
  bold_p(t = 0.0005813953) 

#...... assumptions.......
lm(as.numeric(cut_General_health)  ~ Chronotype + Age + Education  + Gender + religious_age.y, data = data.reg.relig) %>%
  car::vif() # VIF must be < 10, which is ok here
MASS::polr(cut_General_health  ~ Chronotype + Age + Education  + Gender + religious_age.y, data = data.reg.relig,Hess = T) %>%
  brant() # in Brand test, value in column Probability in omnibus test must not be < 0.05 - in this case multinom needs to be used. In our case, value is ok  # for interpretation of the Brant test see: https://rpubs.com/rslbliss/r_logistic_ws
#.......................
ra.c.2 <-
  clm(cut_General_health ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Hypertension")) %>%
  bold_p(t = 0.0005813953) 

#...... assumptions.......
lm(as.numeric(cut_General_health)  ~ Chronotype + Age + Education  + Gender + religious_age.y, data = data.reg.relig) %>%
  car::vif() # VIF must be < 10, which is ok here
MASS::polr(cut_General_health  ~ Chronotype + Age + Education  + Gender + religious_age.y, data = data.reg.relig,Hess = T) %>%
  brant() # in Brand test, value in column Probability in omnibus test must not be < 0.05 - in this case multinom needs to be used. In our case, value is ok  # for interpretation of the Brant test see: https://rpubs.com/rslbliss/r_logistic_ws
#.......................
```
  Ordinal logistic regression revealed that CP being night owls had significantly higher chance of lower general health as compared to early birds - in crude effect (`r inline_text(ra.c.2, variable = Chronotype, pattern = "OR {estimate}; 95% CI ({conf.low}, {conf.high}); {p.value}")`). <!-- As this is the first use of the variable GH and chronotype, there is no need to use Bonferroni --> In the adjusted effect however, this result was non - significant (`r inline_text(ra.c.1, variable = Chronotype, pattern = "OR {estimate}; 95% CI ({conf.low}, {conf.high}); {p.value}")`).
```{r chronic ilnessess regression - cut_General_health, include=FALSE}
# we have 86 analysis thus 0.05/86 = 0.0005813953 = criterion P-value

# data.reg$daily_energy  = relevel(data.reg$daily_energy , ref = "Less than once a week")

data.reg = data.reg %>% 
    mutate(cut_General_health = cut(General_health, 
                                  breaks=c(-Inf, 0, 2, 5, Inf), 
                                  labels=c("No","fiew","several","many")))
#_____________________________________________________________
ra.e.1 <-
  clm(cut_General_health ~ Source + Age + Education  + Gender, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Hypertension")) %>%
  bold_p(t = 0.0005813953) 

#...... assumptions.......
lm(as.numeric(cut_General_health)  ~ Source + Age + Education  + Gender, data = data.reg) %>%
  car::vif() # VIF must be < 10, which is ok here
MASS::polr(cut_General_health  ~ Source + Age + Education  + Gender, data = data.reg,Hess = T) %>%
  brant() # in Brand test, value in column Probability in omnibus test must not be < 0.05 - in this case multinom needs to be used. In our case, value is ok  # for interpretation of the Brant test see: https://rpubs.com/rslbliss/r_logistic_ws
#.......................
ra.e.2 <-
  clm(cut_General_health ~ Source, family = binomial, data = data.reg) %>%
  tbl_regression(exponentiate = TRUE, include = "Source", show_single_row = "Source", 
                 label = list(Source ~ "Hypertension")) %>%
  bold_p(t = 0.0005813953) 

#...... assumptions.......
lm(as.numeric(cut_General_health)  ~ Source + Age + Education  + Gender, data = data.reg) %>%
  car::vif() # VIF must be < 10, which is ok here
MASS::polr(cut_General_health  ~ Source + Age + Education  + Gender, data = data.reg,Hess = T) %>%
  brant() # in Brand test, value in column Probability in omnibus test must not be < 0.05 - in this case multinom needs to be used. In our case, value is ok  # for interpretation of the Brant test see: https://rpubs.com/rslbliss/r_logistic_ws
#.......................
```
  In the next step, we compared CP with the representative sample in the general health. It was found that CP had significantly higher odds of having lower general health in crude effect (`r inline_text(ra.e.2, variable = Source, pattern = "OR {estimate}; 95% CI ({conf.low}, {conf.high}); {p.value}")`). <!-- As this is the first use of the varible general health and chronotype, there is no need to use Bonferroni --> Moreover, in the adjusted effect, the odds of having lower general health slightly increased (`r inline_text(ra.e.1, variable = Source, pattern = "OR {estimate}; 95% CI ({conf.low}, {conf.high}); {p.value}")`).

## Chronotype and health complains
  Table 5 shows the associations between early birds and night owls in health complains in CP sample. The following trends were found after Bonferroni correction: night owls had higher probability of suffering from problems of falling asleep and backache as compared to early birds (in both crude and adjusted effect).
  
<!-- Health complains -->
```{r health complains table 5, include=FALSE}
# Side-by-side Regression Models
# logistic regression model
# we have 98 analysis in total thus 0.05/98 = 0.0002040816 = criterion P-value

data.reg.3 = data %>% 
  mutate(across(starts_with("obtize_"), ~dplyr::recode_factor(.,
                                                     "Not many times per week" = "Not many times per week",
                                                     "Many times a week" = "Many times a week", .ordered = T))) %>% 
  filter(Source %in% (c("Consecrated"))) %>%
  mutate_if(is.factor, droplevels) %>% 
  filter(country %in% "CZ" |
           country %in% "SK") %>% 
    rename("Chronotype" = "daily_energy")

#...... assumptions.......
lm(as.numeric(obtize_1a)  ~ Chronotype + Age + Education  + Gender + religious_age.y, data = data.reg.3) %>%
  car::vif() # VIF must be < 10, which is ok here
#.......................

ra.d.1 <-
  glm(obtize_1a ~ Chronotype + Age + Education  + Gender + religious_age.y, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Headache")) %>%
  bold_p(t = 0.0002040816) 
ra.d.2 <-
  glm(obtize_1a ~ Chronotype, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Headache")) %>%
  bold_p(t = 0.0002040816) 
#_____________________________________________________________
ra.d.3 <-
  glm(obtize_2a ~ Chronotype + Age + Education + Gender + religious_age.y, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Stomachache"))%>%
  bold_p(t = 0.0002040816) 
ra.d.4 <-
  glm(obtize_2a ~ Chronotype, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Stomachache"))%>%
  bold_p(t = 0.0002040816) 
#_____________________________________________________________
ra.d.5 <-
  glm(obtize_3a ~ Chronotype + Age + Education + Gender + religious_age.y, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Backache"))%>%
  bold_p(t = 0.0002040816) 
ra.d.6 <-
  glm(obtize_3a ~ Chronotype, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Backache"))%>%
  bold_p(t = 0.0002040816) 
#_____________________________________________________________
ra.d.7 <- # there was need to remove variable: "religious_age.y" as model did not converged when included
  glm(obtize_4a ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Intestinal problems"))%>%
  bold_p(t = 0.0002040816) 
ra.d.8 <-
  glm(obtize_4a ~ Chronotype, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Intestinal problems"))%>%
  bold_p(t = 0.0002040816) 
#_____________________________________________________________
ra.d.15 <-
  glm(obtize_8a ~ Chronotype + Age + Education + Gender + religious_age.y, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Trouble falling asleep"))%>%
  bold_p(t = 0.0002040816) 
ra.d.16 <-
  glm(obtize_8a ~ Chronotype, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Trouble falling asleep"))%>%
  bold_p(t = 0.0002040816) 
#_____________________________________________________________

ra.d.17 <- # there was need to remove variable: "religious_age.y and Education" as model did not converged when included
  glm(obtize_9a ~ Chronotype + Age + Gender, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Dizziness"))%>%
  bold_p(t = 0.0002040816) 
ra.d.18 <-
  glm(obtize_9a ~ Chronotype, family = binomial, data = data.reg.3) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Dizziness"))%>%
  bold_p(t = 0.0002040816) 
#___________________________________________________________________________________________________________________
ra.d.tab.pok1b=tbl_stack(
  tbls = list(ra.d.1,
              ra.d.3,
              ra.d.5,
              ra.d.7,
              ra.d.15,
              ra.d.17)) %>% 
   modify_header(label = "**Table 2**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 
# printing merged table
ra.d.tab.pok2b=tbl_stack(
  tbls = list(ra.d.2,
              ra.d.4,
              ra.d.6,
              ra.d.8,
              ra.d.16,
              ra.d.18)) %>% 
   modify_header(label = "**Table 2.1**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 

ra.d.t2=tbl_merge(
tbls = list(ra.d.tab.pok1b,ra.d.tab.pok2b),
tab_span = c("**ADJ(ra)**", "**NA(ra)**"))
```

```{r convert gtsum tab into tible 5, include=FALSE}
table.4=ra.d.t2

#show_header_names(table.2)
# if there is need to use this code in the some other research there is need to just replace the names of the columns (e.g. `95% CI_(RA)` by " `95% CI_(EMP)`) and delete or add the number of OR,p-val,CI columns

  # convert to tibble object
  table.4.tib= table.4 %>% as_tibble()
  
  # setting names
names.tab4=c("Table 2",
             "OR_(R)","95% CI_(R)","p-value_(R)", # the first names are crude and second for adjusted effect
             "OR_(Rna)","95% CI_(Rna)","p-value_(Rna)")

table.4 = expss::setnames(x = table.4.tib, new = names.tab4)

  
   #ds=gtsummary::as_tibble(re.tab.1)
   table.4.tib.star = table.4.tib %>%
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '^>', ""))) %>%
   dplyr::mutate(TF_P=across(dplyr::contains("p-val"), ~str_detect(., pattern = "_"))) %>% 
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '__', ""))) %>% 
   dplyr::mutate(stars = across(dplyr::contains("p-val"), ~pander::add.significance.stars(., cutoffs = c(0.05, 0.01, 0.001))))
   table.4.tib.star = table.4.tib.star %>% 
   dplyr::mutate_at(dplyr::vars("OR_(R)"), ~paste0(., c(table.4.tib.star$stars$`p-value_(R)`))) %>%  # if more p value is present there is need add more rows here 
   dplyr::mutate_at(dplyr::vars("OR_(Rna)"), ~paste0(., c(table.4.tib.star$stars$`p-value_(Rna)`))) %>%  
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., " ", ""))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\*+", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+", NA_character_))) 
   # if command is not working there is need to remove in the last commant the ""sta"" column
  
      # creating the new column containing only: OR 95%CI(xx-xx)
    table.4.tib.star = table.4.tib.star %>% 
     mutate(cis1 = paste0('(',table.4.tib.star$`95% CI_(R)`,')'), 
            cis2 = paste0('(',table.4.tib.star$`95% CI_(Rna)`,')'))
    # replacing old columns
    table.4.tib.star = table.4.tib.star %>% 
      mutate(`OR_(R)`=paste(table.4.tib.star$`OR_(R)`, cis1, sep=" "),
             `OR_(Rna)`=paste(table.4.tib.star$`OR_(Rna)`, cis2, sep=" "))
    
    # deleting undesired symbols
    table.4.tib.star = table.4.tib.star %>% 
      select(dplyr::contains(c("Table","OR","TF"))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\[ ]+", " "))) 
    # Adding prefix to corrected values
      # table.4.tib.star = table.4.tib.star %>% 
      # mutate(`OR_(R)` = case_when(table.4.tib.star$TF_P$`p-value_(R)` == "TRUE" ~ paste0("B", sep = "_", `OR_(R)`), 
      #                    TRUE ~ `OR_(R)`),
      #        `OR_(Rna)`= case_when(table.4.tib.star$TF_P$`p-value_(Rna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(Rna)`), 
      #                    TRUE ~ `OR_(Rna)`),
      #         `OR_(RA)`= case_when(table.4.tib.star$TF_P$`p-value_(RA)` == "TRUE" ~ paste0("B", sep = "_",  `OR_(RA)`), 
      #                    TRUE ~ `OR_(RA)`),
      #         `OR_(RAna)` = case_when(table.4.tib.star$TF_P$`p-value_(RAna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(RAna)`), 
      #                    TRUE ~  `OR_(RAna)`))
      
     # selecting only relevant columns
         table.4.tib.star = table.4.tib.star %>% 
          mutate(across(dplyr::contains("OR_"), ~str_replace_all(., "\\[+", " ["))) %>% 
            select(!dplyr::starts_with("TF_P")) %>% 
           tibble::add_row(.after = "Day structure") %>%  # there is need to add as much rows as is the number of rows in second part of the table 
          mutate("Crude effect" = "") %>%  
           mutate("Adjusted effect" = "") %>% 
          select(`Table 2`, "Crude effect", `OR_(Rna)`, "Adjusted effect", `OR_(R)`) %>%    # changing the position of crude effect 
             mutate_all( ~(na_if(., ""))) %>%
           janitor::remove_empty(which = c("cols")) %>% 
           rename("Crude effect" = `OR_(Rna)`,
                  "Adjusted effect" = `OR_(R)`)
         
      # transposing table 
         # convert to wider format
       tab.wide.4 = table.4.tib.star %>%
         t()
```

```{r preparation to print tab 5, message=FALSE, warning=FALSE, include=FALSE}
# the only step here which is required here is to manually divide dataset into four parts and then rbind these togather 

# even a little bit wider
# tab.wide.4%>% ncol()

tr.d.1=tab.wide.4[,c(0:3)] %>% as_tibble(rownames = NA)
tr.d.4=tab.wide.4[,c(4:6)] %>% as_tibble(rownames = NA)         
         
         tab2.d = bind_rows(tr.d.1,tr.d.4)
         tab2.d = tab2.d %>% 
           as_tibble(rownames = NA) %>% 
           rownames_to_column()  %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "\\.+\\.+\\.+[[:digit:]]+", replacement = ""))) %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "Table 2", replacement = ""))) %>% 
           mutate_all(~(replace(., is.na(.), ""))) %>%
           janitor::row_to_names(row_number = 1) 
```

```{r Print regres tab 5, echo=FALSE, message=FALSE, warning=FALSE}
  knitr::kable(tab2.d, "latex", booktabs=T, linesep = "", caption = "Depicts associations (in Odds rations) between eary bird and night owns and health complains (Sample 3)") %>%
  kableExtra::kable_styling(latex_options = c("scale_down","hold_position"),   font_size = 7) %>%  # full_width = T or longtable = T (to the Kable command)
  kableExtra::footnote(general = c("p < 0.05 *, p < 0.01 ** p < 0.001 ***, Adjusted effect was calculated using the following variables as a covariates: Age, Gender, Education and yeas being in clerical order. Values in brackets indicates 95% confidence interval. After Bonferroni correction all results were non - significant."), general_title = "Note:", title_format = c("italic"), threeparttable=T, footnote_as_chunk = T)
```
<!-- end HC -->

## Chronotype and chronic illnessess
  Table 6 represents the results of the logistic regression comparing night owl CP to early bird CP. Although after Bonferroni correction all results were non-significant, several trends might be observed: night owls as compared to early birds had higher odds of developing chronic arthritis (adjusted effect) and anxiety/depression (crude and adjusted effect).

```{r chronic ilnessess regression 6 - chronotype, include=FALSE}
# we have 86 analysis thus 0.05/86 = 0.0005813953 = criterion P-value

# data.reg$daily_energy  = relevel(data.reg$daily_energy , ref = "Less than once a week")

data.reg.relig = data %>% 
  mutate(across(starts_with("hlth_"), ~dplyr::recode_factor(.,
                                                     "0" = "no",
                                                     "1" = "yes"))) %>% 
  filter(Source %in% (c("Consecrated"))) %>% 
  mutate_if(is.factor, droplevels) %>% 
   filter(country %in% "CZ" |
           country %in% "SK") %>% 
  rename("Chronotype" = "daily_energy")

#...... assumptions.......
lm(as.numeric(hlth_hypertension)  ~ Chronotype + Age + Education  + Gender, data = data.reg.relig) %>%
  car::vif() # VIF must be < 10, which is ok here
#.......................

ra.c.1 <-
  glm(hlth_hypertension ~ Chronotype + Age + Education  + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Hypertension")) %>%
  bold_p(t = 0.0005813953) 
ra.c.2 <-
  glm(hlth_hypertension ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Hypertension")) %>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.3 <- # there was need to remove variable: "Education and Gender" as model did not converged when included
  glm(hlth_diabetes ~ Chronotype + Age, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Diabetes"))%>%
  bold_p(t = 0.0005813953) 
ra.c.4 <-
  glm(hlth_diabetes ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Diabetes"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.5 <-
  glm(hlth_arthritis ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Arthritis"))%>%
  bold_p(t = 0.0005813953) 
ra.c.6 <-
  glm(hlth_arthritis ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Arthritis"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.7 <-
  glm(hlth_astma ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Astma"))%>%
  bold_p(t = 0.0005813953) 
ra.c.8 <-
  glm(hlth_astma ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Astma"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.9 <-
  glm(hlth_depression_anxiety ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Depression/Anxiety"))%>%
  bold_p(t = 0.0005813953) 
ra.c.10 <-
  glm(hlth_depression_anxiety ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Depression/Anxiety"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.11 <-
  glm(hlth_ICHS ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Ischemic heart disease"))%>%
  bold_p(t = 0.0005813953) 
ra.c.12 <-
  glm(hlth_ICHS ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Ischemic heart disease"))%>%
  bold_p(t = 0.0005813953)
#_____________________________________________________________
ra.c.13 <-
  glm(hlth_obesity ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Obesity"))%>%
  bold_p(t = 0.0005813953) 
ra.c.14 <-
  glm(hlth_obesity ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Obesity"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.17 <-
  glm(hlth_back_pain ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Back pain"))%>%
  bold_p(t = 0.0005813953) 
ra.c.18 <-
  glm(hlth_back_pain ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Back pain"))%>%
  bold_p(t = 0.0005813953) 
#___________________________________________________________________________________________________________________
ra.c.19 <- # there was need to remove variable: "Age and Education" as model did not converged when included
  glm(hlth_gastric_or_duodenal_ulcers ~ Chronotype + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Gastric or duodenal ulcers"))%>%
  bold_p(t = 0.0005813953) 
ra.c.20 <-
  glm(hlth_gastric_or_duodenal_ulcers ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Gastric or duodenal ulcers"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.21 <- # there was need to remove variable: "Gender and Education" as model did not converged when included
  glm(hlth_chronic_lung_disease ~ Chronotype + Age, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Chronic lung disease"))%>%
  bold_p(t = 0.0005813953) 
ra.c.22 <-
  glm(hlth_chronic_lung_disease ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Chronic lung disease"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.23 <-
  glm(hlth_skin_diseases_eczema ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Skin diseases eczema"))%>%
  bold_p(t = 0.0005813953) 
ra.c.24 <-
  glm(hlth_skin_diseases_eczema ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Skin diseases eczema"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.25 <-
  glm(hlth_allergy ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Allergy"))%>%
  bold_p(t = 0.0005813953) 
ra.c.26 <-
  glm(hlth_allergy ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Allergy"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.27 <-
  glm(hlth_migraine ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Migraine"))%>%
  bold_p(t = 0.0005813953) 
ra.c.28 <-
  glm(hlth_migraine ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Migraine"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.29 <-
  glm(hlth_pain_of_unclear_origin ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Pain of unclear origin"))%>%
  bold_p(t = 0.0005813953) 
ra.c.30 <-
  glm(hlth_pain_of_unclear_origin ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Pain of unclear origin"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.31 <-
  glm(hlth_for_wom_pain_in_the_small_ ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Pain in the small pelvis"))%>%
  bold_p(t = 0.0005813953) 

ra.c.32 <-
  glm(hlth_for_wom_pain_in_the_small_ ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Pain in the small pelvis"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.33 <- # there was need to remove variable: "Gender and Education" as model did not converged when included
  glm(hlth_cancer ~ Chronotype + Age, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Cancer"))%>%
  bold_p(t = 0.0005813953) 
ra.c.34 <-
  glm(hlth_cancer ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Cancer"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________
ra.c.35 <-
  glm(hlth_thyroid_disease ~ Chronotype + Age + Education + Gender, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Thyroid disease"))%>%
  bold_p(t = 0.0005813953) 
ra.c.36 <-
  glm(hlth_thyroid_disease ~ Chronotype, family = binomial, data = data.reg.relig) %>%
  tbl_regression(exponentiate = TRUE, include = "Chronotype", show_single_row = "Chronotype", 
                 label = list(Chronotype ~ "Thyroid disease"))%>%
  bold_p(t = 0.0005813953) 
#_____________________________________________________________

ra.c.tab.pok1=tbl_stack(
  tbls = list(ra.c.1,
              ra.c.3,
              ra.c.5,
              ra.c.7,
              ra.c.9,
              ra.c.11,
              ra.c.13,
              ra.c.17,
              ra.c.19,
              ra.c.21,
              ra.c.23,
              ra.c.25,
              ra.c.27,
              ra.c.29,
              ra.c.31,
              ra.c.33,
              ra.c.35)) %>% 
   modify_header(label = "**Table 2**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 
# printing merged table
ra.c.tab.pok2=tbl_stack(
  tbls = list(ra.c.2,
              ra.c.4,
              ra.c.6,
              ra.c.8,
              ra.c.10,
              ra.c.12,
              ra.c.14,
              ra.c.18,
              ra.c.20,
              ra.c.22,
              ra.c.24,
              ra.c.26,
              ra.c.28,
              ra.c.30,
              ra.c.32,
              ra.c.34,
              ra.c.36)) %>% 
   modify_header(label = "**Table 2.1**") %>%  
     modify_footnote(ci ~ "CI = Confidence Interval, bold p value is corrected",
                     abbreviation = T) 

ra.c.t1=tbl_merge(
tbls = list(ra.c.tab.pok1,ra.c.tab.pok2),
tab_span = c("**ADJ(ra)**", "**NA(ra)**"))
```

```{r convert gtsum tab into tible 6, include=FALSE}
table.3=ra.c.t1

#show_header_names(table.2)
# if there is need to use this code in the some other research there is need to just replace the names of the columns (e.g. `95% CI_(RA)` by " `95% CI_(EMP)`) and delete or add the number of OR,p-val,CI columns

  # convert to tibble object
  table.3.tib= table.3 %>% as_tibble()
  
  # setting names
names.tab3=c("Table 2",
             "OR_(R)","95% CI_(R)","p-value_(R)", # the first names are crude and second for adjusted effect
             "OR_(Rna)","95% CI_(Rna)","p-value_(Rna)")

table.3 = expss::setnames(x = table.3.tib, new = names.tab3)

  
   #ds=gtsummary::as_tibble(re.tab.1)
   table.3.tib.star = table.3.tib %>%
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '^>', ""))) %>%
   dplyr::mutate(TF_P=across(dplyr::contains("p-val"), ~str_detect(., pattern = "_"))) %>% 
   dplyr::mutate(across(dplyr::contains("p-val"), ~str_replace_all(., '__', ""))) %>% 
   dplyr::mutate(stars = across(dplyr::contains("p-val"), ~pander::add.significance.stars(., cutoffs = c(0.05, 0.01, 0.001))))
   table.3.tib.star = table.3.tib.star %>% 
   dplyr::mutate_at(dplyr::vars("OR_(R)"), ~paste0(., c(table.3.tib.star$stars$`p-value_(R)`))) %>%  # if more p value is present there is need add more rows here 
   dplyr::mutate_at(dplyr::vars("OR_(Rna)"), ~paste0(., c(table.3.tib.star$stars$`p-value_(Rna)`))) %>%  
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., " ", ""))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\*+", " "))) %>% 
   dplyr::mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+", NA_character_))) 
   # if command is not working there is need to remove in the last commant the ""sta"" column
  
      # creating the new column containing only: OR 95%CI(xx-xx)
    table.3.tib.star = table.3.tib.star %>% 
     mutate(cis1 = paste0('(',table.3.tib.star$`95% CI_(R)`,')'), 
            cis2 = paste0('(',table.3.tib.star$`95% CI_(Rna)`,')'))
    # replacing old columns
    table.3.tib.star = table.3.tib.star %>% 
      mutate(`OR_(R)`=paste(table.3.tib.star$`OR_(R)`, cis1, sep=" "),
             `OR_(Rna)`=paste(table.3.tib.star$`OR_(Rna)`, cis2, sep=" "))
    
    # deleting undesired symbols
    table.3.tib.star = table.3.tib.star %>% 
      select(dplyr::contains(c("Table","OR","TF"))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "NA", " "))) %>% 
      mutate(across(dplyr::contains("OR"), ~str_replace_all(., "^\\s+\\[ ]+", " "))) 
    # Adding prefix to corrected values
      # table.3.tib.star = table.3.tib.star %>% 
      # mutate(`OR_(R)` = case_when(table.3.tib.star$TF_P$`p-value_(R)` == "TRUE" ~ paste0("B", sep = "_", `OR_(R)`), 
      #                    TRUE ~ `OR_(R)`),
      #        `OR_(Rna)`= case_when(table.3.tib.star$TF_P$`p-value_(Rna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(Rna)`), 
      #                    TRUE ~ `OR_(Rna)`),
      #         `OR_(RA)`= case_when(table.3.tib.star$TF_P$`p-value_(RA)` == "TRUE" ~ paste0("B", sep = "_",  `OR_(RA)`), 
      #                    TRUE ~ `OR_(RA)`),
      #         `OR_(RAna)` = case_when(table.3.tib.star$TF_P$`p-value_(RAna)` == "TRUE" ~ paste0("B", sep = "_", `OR_(RAna)`), 
      #                    TRUE ~  `OR_(RAna)`))
      
     # selecting only relevant columns
         table.3.tib.star = table.3.tib.star %>% 
          mutate(across(dplyr::contains("OR_"), ~str_replace_all(., "\\[+", " ["))) %>% 
            select(!dplyr::starts_with("TF_P")) %>% 
           tibble::add_row(.after = "Day structure") %>%  # there is need to add as much rows as is the number of rows in second part of the table 
          mutate("Crude effect" = "") %>%  
           mutate("Adjusted effect" = "") %>% 
          select(`Table 2`, "Crude effect", `OR_(Rna)`, "Adjusted effect", `OR_(R)`) %>%    # changing the position of crude effect 
             mutate_all( ~(na_if(., ""))) %>%
           janitor::remove_empty(which = c("cols")) %>% 
           rename("Crude effect" = `OR_(Rna)`,
                  "Adjusted effect" = `OR_(R)`)
         
      # transposing table 
         # convert to wider format
       tab.wide.3 = table.3.tib.star %>%
         t()
```

```{r preparation to print tab 6, message=FALSE, warning=FALSE, include=FALSE}
# the only step here which is required here is to manually divide dataset into four parts and then rbind these together 

# even a little bit wider
# tab.wide.3 %>% ncol()

tr.1.3=tab.wide.3[,c(9:13)] %>% as_tibble(rownames = NA)
tr.4.3=tab.wide.3[,c(5:8)] %>% as_tibble(rownames = NA)         
tr.2.3=tab.wide.3[,c(0:4)] %>% as_tibble(rownames = NA)
tr.3.3=tab.wide.3[,c(14:18)] %>% as_tibble(rownames = NA) 
         
         tab_3 = bind_rows(tr.1.3,tr.4.3,tr.2.3,tr.3.3)
         tab_3 = tab_3 %>% 
           as_tibble(rownames = NA) %>% 
           rownames_to_column()  %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "\\.+\\.+\\.+[[:digit:]]+", replacement = ""))) %>% 
           mutate(across(starts_with("rowname"), ~ str_replace_all(., "Table 2", replacement = ""))) %>% 
           mutate_all(~(replace(., is.na(.), ""))) %>%
           janitor::row_to_names(row_number = 1) 
```

```{r Print regres tab 6, echo=FALSE, message=FALSE, warning=FALSE}
  knitr::kable(tab_3, "latex", booktabs=T, linesep = "", caption = "Depicts associations (in Odds rations) between eary bird and night owns clerics and chronical mental and physical deseases (Sample 3)") %>%
  kableExtra::kable_styling(latex_options = c("scale_down","hold_position"),   font_size = 7) %>%  # full_width = T or longtable = T (to the Kable command)
  kableExtra::footnote(general = c("p < 0.05 *, p < 0.01 ** p < 0.001 ***, Adjusted effect was calculated using the following variables as a covariates: Age, Gender, Education and number of years being part of the clerical order. Values in brackets indicates 95% confidence interval. After Bonferroni correction all results were non - significant. Variable stroke was excldued from analysis, because regression model containing this variable not converge."), general_title = "Note:", title_format = c("italic"), threeparttable=T, footnote_as_chunk = T)
```

# Discussion

The aim of the study was to assess the relation between living as a consecrated person in religious institutes in the Czech Republic and in the Slovak Republic and general health. Compared to a Czech national representative sample, the results showed a lower probability of suffering from diabetes in CP. However, CP were found to be in a higher risk of obesity and pain in the small pelvis (women CPs) and they seem to tend more to thyroid disease. Further, we discovered no significant results in health complaints of CP in comparison with the control sample. Only the item “trouble falling asleep” in the religious sample was close to the significance threshold. Moreover, CP had significantly more chronic diseases. More specifically, when focusing only on CP, we found a higher risk of suffering from chronic illnesses for “night owls” compared to “larks”, though only in crude effect. “Night owl CP” seem to suffer more from arthritis, backache and depression/anxiety and have more problems with falling asleep.
	The association of being a consecrated person with higher risk of obesity (table 2) can be explained by several reasons. According to some findings, higher tendency to obesity is observed among believers in general [@koenig2012religion]. Further, although there are no specialised studies in this social group, some general findings can be applied considering the reality of religious communities. Regarding the high-performance orientation, enrooted for many decades particularly in apostolic religious congregations [@jakvsivcova2021sluzebnici], we can suppose the lack of sport and physical exercise as well as the lack of sleep, which is often connected with unhealthy eating habits [@narcisse2018mediating].  Furthermore, some religious communities still tend to follow the old uniforming rules which do not support individual diets [@jakvsivcova2012dcery]. In this case, all members are supposed to eat the same food, which may not be appropriate for everybody. The performance pressure is also related with higher level of stress as another factor leading to unregulated eating [@ling2021relationships; @leow2021understanding] and potentially elevated levels of cortisol, which is further influencing one´s metabolism [@kistenmacher2018psychosocial]. The high-performance orientation and stress can also contribute to the higher tendency of CP to suffer from thyroid disease, because chronic stress seems to be one of the important factors lead-ing to this illness, as reported by Cremaschi et al. [@cremaschi2000chronic]. 
On the contrary, though a higher risk of diabetes could be expected among CP due to the already described higher risk of obesity, which belongs to the main risk factors of diabetes [@brovz2020prevalence], our results did not support this presumption. These findings may be explained by the fact that another factor significantly contributing to the development of diabetes is smoking [@brovz2020prevalence], which is, however, quite rare among CP. Women CPs are non-smokers [@butler1996trends] and there is only a small group of smokers among priest and men CPs [@stang2012cancer]. However, more data would be needed to support this potential explanation.
	Moreover, we found two or three times higher risk of the small pelvis pain among religious sisters. There might be several reasons for this. Life in celibacy includes a higher risk of psychosomatic complaints caused by libido-suppression and of psychosexual problems [@baumann2019spiritual]. Further, we can argue that issues regarding sexuality are in some extent still taboo in religious institutes, because this approach is deeply enrooted in the mentality of elderly sisters, which also tends to self-denial and ignoring of health problems [@jakvsivcova2021sluzebnici]. Therefore, it may be challenging for some consecrated women to visit gynaecologist regularly and to solve the starting complaints soon enough. According to the latest findings of Nygaard et al. [@nygaard2020baseline], in case of chronic pelvic pains, early intervention is important to reduce the complaints successfully. It remains a task for the future research to study the extent of traumatic experiences with sexual abuse among CP compared with a sample of non-CPs, because it might be another possible reason for the chronic small pelvis pain in CP [@heim1998abuse].
	Our finding of a lower general tendency of CP to have sleep disturbance remained close to significance threshold and more data would be needed to confirm it. However, religious community members with “night owl” chronotype reported sleep disturbances significantly more often than “lark CP”. Looking only at the religious sample, “night owls” declared evidently higher probability to have troubles falling asleep than “larks”. A common daily routine in a religious community is strictly oriented to getting up early and going to bed early, which is favourable for “larks” and inconvenient for “owls”, who have to adapt to this routine. In some extent, it may be useful for them, because shifting sleep/wake timings in “night owls” to earlier hours showed positive effects on their performance and mental health, as reported by Facer-Childs [@facer2019resetting]. However, the biorhythm still might cause difficulties to fall asleep early. As a consequence, some “owl-brothers/owl sisters” seem to give up going to bed early and to continue working late in the evening according to their chronotype, but they have to respect the regime given and get up early to attend the community morning prayer. It may result in the chronic lack of sleep in this group of consecrated persons, possibly leading to other health issues.
	Several studies exploring the individual chronotype concluded, that the definite evening types – “night owls” show higher rates of metabolic dysfunction and cardiovascular disease and are in higher mortality risk [@knutson2018associations]. Our sample is too small to discuss this topic, however, it showed some results about evening types having worse health characteristics. The revealed connection between being a “night owl CP” and a higher risk of depression is consistent with the general findings about this chronotype [@facer2019resetting]. Furthermore, these CP may be stressed by the permanent lack of sleep, which can contribute to a development of  depression. The higher backache tendency in “night owl CP” may be a psychosomatic consequence of a higher stress level [@hajnovic2018causal]. A higher risk of arthritis in “night owl CP” does not correspond with the previous findings of Habers et al. about rheumatoid arthritis patients showing an earlier circadian rhythm [@habers2021earlier]. However, our sample is not large enough and we would need more data to check up this potential assotiation.
	When comparing Czech and Slovak CP with the Czech representative sample regarding the general health, we found significantly higher risk of having worse general health for CP. Moreover, these findings are supported by a trend, however insignificant, that could be observable in most of the chronic diseases in our study. These findings correspond to our hypothesis that comparing to the results from USA [@schott2019stability; @weinstein2019autonomous], there are more negative health-effecting factors in CP in CZ and SK. It seems to be connected with different mentality and lifestyle of CP in the USA and in CZ/SK, influenced by the major society and the historical, cultural and ecclesiastical background, especially with delayed and just partial reception of postconciliar changes after Vaticanum II, which is typical for the post-communist countries [@fiala2000koncil; @balik2012letnice].  The Czech/Slovak CP still seem to tend to the traditional performance-oriented lifestyle characterised by strict self-denial [@petravcek2013sekularizace]. Thus, possibly reasons for the worse general health in Czech/Slovak CP could be overworking, stress and lack of active and passive rest caused by the stereotyped regime of the communities, unadapted to their actual situation and not giving enough space for leisure and relaxation of individuals. Perhaps also higher incidence of psychosomatic problems could be considered. All these are hypotheses for future research.
Strengths and limitations
This study has several important strengths, the most important is that it is the first study about consecrated persons living in the specific milieu of two post-communist countries. The study is based on the first blanket research among CP in these countries, which is covering many dimensions of consecrated life and allows to investigate various factors of living in a religious community. Moreover, as a comparion, this research uses a large nationally representative Czech sample and another large professionally gathered online sample close to national charcteristics. Nevertheless, not having nationally representative data from a Slovak sample represents a certain limitation of this study. We accept that the numbers could slightly change if these would be included, as there are slight differences between Czechs and Slovaks in life expectancy and prevalence of some chronic illnesses [@vagavsova2017disparities]. Nevertheless, we do not suppose these potential differences changing the finding that consecrated persons in CZ and SK in our sample seem to have similar or worse general health compared to the major population. Another limitation of our study is related to the fact that the sample of CP is relatively small because of the general mistrust of CP towards surveys asking personal questions. We can also expect a certain selection bias in the sample, supposing the more active, more interested and healthier CP more likely to fill in the questionnaire. However, in case of this study, this selection bias seems rather to affirm the conclusion about the lower general health of CP.
Implications
	Our findings suggest that there is a need for  researchers and also for spiritual directors to focus more deeply on internal structures, daily routine, relationships, working habits and mental hygiene in religious communities. These issues should also be discussed directly in the religious communities and in the courses for religious formators. Furthermore, doctors, psychologists, counsellors and other helping professions should be informed more about the lifestyle of consecrated persons.
Future research should be oriented to revealing positive and negative health effecting factors among CP, comparing CP both from local communities of one country and from different countries and cultural contexts, so that generally spread and culturally conditioned factors can be distinguished.


# Conclusion

According to our findings, compared to the major society, persons living the consecrated life in the post-communist Czech Republic and Slovak Republic tend to have a similar or a slightly worse general health. The results differ from the US findings pointing at the positive health effects of spiritual experience and structured daily routine. Thus, this study shows the importance of more detailed research in the way of life of (not only) Czech and Slovak religious communities to determine factors that could be contributing to their negative health outcomes.
Ethics statement
	The study design was approved by the Ethics Committee of the Olomouc University Social Health Institute (No. 2021/3).


# Patents

<!-- This section is not mandatory, but may be added if there are patents resulting from the work reported in this manuscript. -->
